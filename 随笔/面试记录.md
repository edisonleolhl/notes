# 暑期实习面试记录

## CVTE一面（已挂）

通过1.5笔试，挂在1.13现场一面

自我介绍一下吧

挑个印象最深刻的项目讲讲，比赛一个人吗？你负责什么？openflow协议是什么？

c++多态怎么实现（编译时多态用重载，运行时多态用虚函数），虚函数怎么实现，答到虚函数指针位于类实例的头部时，面试官打断问如果有继承的话虚函数指针放哪？我吞吞吐吐说可能忘记了，但我知道内存对象模型，然后扯了堆、栈、只读数据区、代码段等等

堆栈的区别，栈保存局部变量、函数返回地址与参数，系统自动释放，堆保存new出来的，如果不delete会内存泄露，然后扯了一下自己看过一篇文章说c++的自由存储区实际上是用堆实现的，只是语言背景不同而已。再问增长方向，回答栈向下，堆向上，在纸上画了个图。忘记答堆栈的在系统资源层面上的区别了。

有用过智能指针吗？autoptr与weakptr讲讲，我说weakptr主要是为了解决sharedptr的循环引用使引用计数失效，追问手写代码举例autoptr循环引用（没写出来）

uniqueptr是什么，回答独占对象，举个例子独占对象（没写出来）

匿名函数有哪些捕获，我说值捕获引用捕获指针捕获，面试官问有指针捕获？我赶紧改口外部捕获，面试官说没有外部捕获，那我说我的答案就是值捕获与引用捕获，没深问了

TCP udp区别，面向连接有区别，可靠性有区别，拥塞控制有区别，连接对象有区别，说到udp可以一对多，面试官有疑问，我说组播，随手画了个图，可能比较自信就没深问了，首部固定字节有区别，说到udp首部固定8字节时，面试官打断问有哪几个字段，我说源和目的端口还有检验和还有最后一个是协议号还是什么的，面试官说只有三个，答的中规中矩（其实应该是4个，源和目的端口、校验和、数据长度）

tcp拥塞控制，回答reno vegas两个版本，前期只有慢启动，拥塞避免，后来加入快恢复与快重传，每个阶段用画图表示，问我坐标轴是什么，我说横坐标传输轮次，纵坐标拥塞窗口，这题答的不错

为什么有time wait阶段，答了计网书上两个原因，应该答的还可以

有动手写过网络编程吗，回答没有自己亲自实现过就没问了（减分项）

有听过粘包吗，我说没有，他说在网络编程中经常有的现象（减分项）

手写算法，判断字符串是否对称，我说从中间分开，双指针比较往两边移动一一比较，写到一半时说要注意边界情况，给他说了一下需要考虑奇偶情况

进程与线程的区别，答了资源分配的最小单位与cpu调度的最小单位，进城的定义， 进程间通信更复杂，地址空间独立与不独立，一个线程挂掉会影响其他线程 ，线程系统开销小，感觉没答完，想了一会说暂时只记得这几个

总结：面试官挺帅的，很温柔，面试官前面摆着台电脑，用来看题库和写面试者的表现，面试者是看不到的，桌上有白纸和笔，随时准备手写代码，回头来看，当时准备的真的很差劲。。。

## 淘宝商家技术部一面

2.24 17:00-17:30，因为收我简历的面试官是搞Java的，对我又很感兴趣，就让我面Java的岗位了

简历、项目

引用和指针，追问了哪个是对象

面向对象怎么理解（继承、封装、多态）

多态与虚函数

动态内存分配（new delete）

笔试：实现一个函数，传入两个字符串数组，返回共同字符串，要求用C++、Java、Python三种语言都实现一遍，最后跟面试官确定了是去重的（用set很快就实现了，难点在于三个语言实现，所以我为啥要说我学过三门语言呢？）

总结：预面，不难，纯聊天

## 钉钉一面

2.25 16:30-18:00，代码写得比较久

自我介绍、简历、项目

介绍一下智能指针（auto_ptr已废弃，unique_ptr独占式/禁止拷贝，shared_ptr引用计数/自动析构/死循环，weak_ptr弱引用解决shared_ptr死循环的问题）

介绍一下STL，基本上按照STL源码剖析来的，空间配置器两级、空闲链表、内存碎片，迭代器粘合剂、隐藏内部实现、萃取，容器vector、list、heap、set、map，仿函数、适配器inserter与基于deque的stack和queue

介绍一下操作系统，我主要说了一下内存管理（交换技术、虚拟内存：页表页面页框，页面置换算法LRU）与死锁（提到了华为比赛，四个产生原因）的理解

CPU调度方式有了解过吗（Round Robin，优先级调度，优先级调度可能会产生饥饿的问题，解决方法是偶尔提升一下优先级，还有一些基于优先级的变种调度方法）

进程间通信（管道、信号、信号量、共享内存、消息队列、套接字，还多说了一下最好的是套接字，因为可以跨主机，在管道那里还提到pipe函数中，fork后父子进程一个关fd[0]一个关fd[1]，以及单工的问题）

网络编程，介绍一下epoll（先说了I/O复用的好处，内核注册事件表、LT与ET）

为什么要有time wait（两个原因），time wait过多怎么办（重用与快速回收）

数据库MySQL的索引是什么，简单介绍一下（B+树，减少磁盘IO，数据存在叶子节点，叶子节点有顺序的指针，可供范围循环）

MySQL的主键索引和副键索引（我回答只知道主键是唯一的，没具体了解过）

你了解哪些开源产品（我说了阿里的Dubbo，分布式的RPC框架，说了一下RPC的概念）

服务器怎么负载均衡（我说服务器集群，类似线程池那样，一个负责接收连接，具体业务交给其他服务器）

HTTP1和2的区别（没怎么答上来，但我还是说了一下我的推测，更安全的SSL、缓存更好、状态码更多、交互更加丰富）

网页编辑器白板手撕代码：合并k个有序链表

拿到题后我说了我的想法，可以转化为两个有序链表的合并，这样合并k-1次两个链表即可，但面试官表示效率不理想

然后我就想到了刚才的做法会重复比较，于是说了个更快的想法：依次比较k个链表头部，把其中的最小值加到输出链表后面，这个得到最小值的链表的cur指针后移一位

写完后在面试官提示下想起了用最小堆改善最小值的操作

总结：总体而言很轻松，很多题目都是开放的，我可以尽情吹我知道的所有知识：）

## 淘宝商家技术部二面（已挂）

2.26 10:00~12:40，全程瑟瑟发抖

项目30分钟，问的很细，调度器和计算结果那里没搞懂，一直在问

类和对象（封装、继承、多态）

为什么有类型（扯汇编，扯安全），C++和Java是强类型语言（不知道。。。）

三种语言关于继承的知识，C++因为虚函数有菱形继承的问题所以引入虚基础，Java不支持多重继承，但有implement多个接口可以间接实现，Python最基本的单继承、多继承、多级继承、混合继承都支持，没有特别

友元举个例子，我举的例子是钱的账户account与存取的交易transaction，account内部不应该定义add和sub方法，而应该交给transaction去操作，更加安全，而且也符合类的松耦合，类的规模尽可能小

手撕代码（可以在本地IDE写，共享屏幕）

设计一个访问控制IP的类，一分钟内超过30次访问，该IP在接下来的3分钟每分钟只能访问三次（限时一个小时，可以上网查一些接口用法，基本功能都没写出来，我太渣了-_-）

实现LRUCache（限时半个小时，写完后设计一下测试用例，有点小bug，最早的项目没有移除）

总结：大佬不愧是大佬，瑟瑟发抖，在项目那里刨根问底，类与对象那里讨论了很久，第一个代码题有点难

## 腾讯TEG一面（直系师姐内推）

3.2 11：20-12：20，电话面试

自我介绍

华为比赛，死锁，优化手段

科研，背景，怎么实现的，定价策略，控制器集群（对方是做分布式存储的），

深拷贝与浅拷贝

析构函数为什么是虚的

三次握手交换了什么（seq/ack+发送窗口），发送窗口是干什么的，解释滑动窗口协议

信号和信号量的区别

IO协议栈是什么（不懂，能不能给点解释），面试官举例说打开一个文件，从键盘输入再保存，这段时间发生了什么。我回答说键盘是外设，产生IO中断，CPU读取放入内存，再从内存放入磁盘。面试官追问读取数据怎么从内存写入磁盘，我扯了一些页面置换什么的（答非所问），中间我还扯到了L1 L2 L3缓存，被追问里面有什么，我不是特别了解，只说了有一些寄存器什么的。

32位系统，地址空间是多大（2^32=4GB）

物理地址空间和虚拟地址空间怎么转换（扯了一些基本定义，最后坦言具体怎么转换的不知道，答案应该是MMU）

内存有哪些技术（开放回答，交换技术与虚拟内存，重点讲虚拟内存、页面页框页表、缓存淘汰的策略一般是LRU）

算法题：以单词为最小单位翻转字符串，先整体翻转，然后遍历，碰到空格时把前面一小段翻转（单词翻转）

算法题：10万个数字找重复数据，我回答了哈希表、位图、布隆过滤器、排序

还有什么想问，为了表现一下自己，问了一下对方产品怎么做的一致性，还问了有没有借鉴PAXOS与RAFT算法，对方给我讲了挺多关于存储的知识

总结：没问网络并发与数据库，除了操作系统的几个问题，其他都答的挺好的，看来要多看看操作系统的细节了，最后的提问交流还挺愉快的

师姐反馈，过了一面，等3.5开系统就二面。

## 阿里零售通一面（未选择）

3.5电话一面，54min，投的后台，因为没有后台没有C++，所以推给了做搜索引擎的算法组，所以对算法扣的很细

抓项目，介绍SDN，问SDN大赛，问流量调度算法，这几年做了什么成果

再抓项目，dijkstra怎么改良，为什么要用dijkstra，floyd为什么不好，时间复杂度怎么计算，松弛操作是啥

再再抓项目，LDA算法是啥（稍微介绍了下，具体原理没了解），狄利克雷分布是啥（不知）

指针和数组的区别（谈到了浅拷贝）

浅拷贝和深拷贝的区别

介绍一下排序算法（冒泡、插入、快排，扯了下STL的内省排序、堆排序、归并，还说了下三种O(n)时间复杂度的计数排序、桶排序、基数排序）

有什么想问的，我问了他们搜索具体是做什么，团队规模多大（说只有两位同学。。。这有HC吗？

## 阿里国际化一面

3.6 1h，Java岗位

自我介绍

内存泄漏，new,delete,malloc,free,构造函数,析构函数，智能指针，循环引用，深拷贝浅拷贝

Linux开机的过程（bios，硬件自检，启动MBR，init，在inittab配置文件中确定运行权限，开启用户进程

Linux装载的概念（我说一切皆文件，为了让操作系统知道如何操作文件，就需要装载，但查了下，面试官应该问的是挂载（mount）的概念吧

软连接和硬链接（我说这好像是文件系统里的概念，我不太了解）

Linux命令cat，如何实现tac，反过来输出文件，我说fseek从后往前扫描文件里的每一行，用一个while循环，到头就结束

如果文件很大，无法一次性装入内存，怎么办，我说会产生缺页中断，说了下虚拟内存的机制

synflood是啥，怎么产生危害的，如何避免，我说服务器不重传那么多次第二次握手，早点结束，后来又扯到了SDN大赛做的源地址验证

引入SDN大赛，介绍SDN概念，起源，优势

说说hashmap，STL，哈希冲突，开链法和开放地址寻址法，开链法怎么优化时间复杂度（我首先说vector，插入时排序，然后二分查找，后来面试官说vector的插入不太好，我想到了红黑树，但还是在面试官提示下才想到要把哈希表和红黑树结合，我当时想的是何必在unordered_map里面再用map，直接用map就好了，但是面试官的要求是想在哈希表最差情况下是O(logn)的查找时间，所以要两者结合）

红黑树的性质，为什么比树要好，在哪里有应用（我回答了epoll里面）

15min反转单链表，一次性AC了，还不错

## 腾讯TEG二面

3.6 牛客网1h

SDN项目，讲到令牌桶，问我怎么实现，我说队列，差点讲生产者消费者模型（我怕我讲了之后要我现场实现一个）

华为比赛，碰到什么技术难点，怎么实现的

epoll的工作模式，优缺点

select怎么做的，缺点，内存开销

重载怎么实现的，名字翻译

虚函数

管道分为哪几种，匿名管道怎么实现的（fork，拷贝父进程地址空间，共享同一个管道socket，所以可以匿名通信

手撕代码：二叉树的（最大）宽度。牛客网面试房间，写完之后要调用main函数输出的。

当天师姐反馈，过了二面，三面是大boss，很严肃，可能会很有压力，做好心理准备（事实证明，做了心理准备也没用。。）

## 阿里国际化二面（未选择）

3.7 50min，两道代码题：输出链表倒数第k个节点+青蛙跳房子

面试官面的是Java岗，我坦白投的是C++，所以运气很好地给我换成了两个算法题，而且都不难，做的不错

## 腾讯TEG三面

3.10 腾讯会议1h

怼项目，优化手段都没问、调度器也没问，就问为什么会有死锁，我回答说调度规则决定的，能否试探加锁去解决死锁，我说不行，因为车辆不准只走一部分，如果它没法走满速度，那它会等待，这样有可能会循环等待，举了个四方形环路的例子，这个例子给出来后才打消了面试官的疑虑，庆幸当时能够在巨大的压力下构建出一个死锁场景。

问SDN项目遇到的困难，我说用户与控制器通信的方式弄了很久才知道，面试官认为这是一个很基础的功能，任何SDN控制器都要提供，说我技术选型有问题，我回答最开始没想到需要这个功能，这个框架已经搭建好了，所以就没想其他SDN控制器，这需要自己手动实现，最后是通过NAT技术转换实现的用户与控制器通信的（这块有点减分，说我技术选型有问题，语气略生硬）。SDN项目里的时延检测模块，为何精度要好（SDN环境下，交换机没有能力处理包头，所以要上交给控制器，所以得自己实现检测方法），时间是怎么得到的（我回答说Python的time库，调用time.time()即可得到当前时间），追问time函数返回值的精度是多少（我被怼的有点慌了，这里也忘记具体精度了，被狠狠地怼了一番）

Linux的定时精度，怎么往前走的（晶振，产生一个滴答，定时器，如时间轮，这里应该算是回答上来了）

进程间通信，要发送10GB数据，要怎么做，首先说了管道，再socket，然后用socket距离说了流程：因为socket有缓冲区，所以可以先分段，然后再一边写，一边读。然后后问我IPC哪个方式最快，回答共享内存，话题转移到共享内存的实现了，我说mmap，问我有没有实际写过，我说没有，但我知道一些应用场景。

mmap有哪些应用（malloc分配内存，以及epoll往内核注册事件，这里回答上来了）

集合，里面每个数字都有两个，只有一个数字只有一个（我回答异或，问我有没有其他的，我说哈希表，然后详细说了两种方法的具体实现以及时空复杂度）

智力题，药丸（回答出来了）

总结：面试官给我的压力很大，说话语速很快，整个面试处于一种很紧张的状态，被怼项目的时候差点想放弃，但还是坚持面完了，可以说，这次面试极大地提高了我的承压能力。

面完问师姐，暂时还没消息，我以为凉凉了，当天晚上告诉我过了，激动万分。

但是面试状态一直是复试，中间拜托师姐催催，但是还是没反应，直到3.19，观望状态突然变为了初试，我慌了，赶紧问师姐，师姐问了HR，说两种可能：要么凉、要么换组了。当时万念俱灰，非常沮丧。

3.20状态又变为了复试，我懵了，晚上状态直接变为了HR面试，开心极了。

## 钉钉二面

3.11 1h

介绍项目的时候没怎么提我的SDN比赛与科研项目，重点说了华为软件精英挑战赛

死锁怎么解决的，为什么产生死锁就得回溯or重来（因为调度规则的原因，车速必须打满，否则得等待）

看我比赛用Python写的，问我为什么Python比C++慢，我回答说一个是静态编译语言，一个是解释型脚本语言，C++对内存控制更加贴近底层blabla，Python和C++各有什么优势（Python脚本，快速搭建原型，追求性能再用C++重写）

const常量与宏定义常量的区别

C++多线程了解吗，要注意什么，有什么锁，问到读写锁，我说C++里面好像没有读写锁，他说是操作系统里的读写锁

内存泄漏怎么办

shared_ptr重载了=运算符，里面有什么，要注意什么，返回值是什么

服务器端有100万个TCP长连接，可能会出现的问题，首先回答说一个连接占用一个socket，socket有最大数量限制，没法支持100万个，然后说一个TCP连接还有发送缓冲区和接收缓冲区，追问大小是多少，我说记不太清了，4196kb，通过套接字选项或内核文件可修改，然后继续回答100万个TCP连接可能会把内存占满。后面还答了CPU不够，可能计算不过来，导致客户端发送请求后久久得不到响应

DDoS是什么

SYN FLOOD怎么处理，我说清洗非法源地址加上服务器端减少重传第二次握手包的次数or快速放弃连接，再问有什么方法可以减少SYN包带来的资源消耗，我说TCP fast open，然后解释了一通，但好像不是他想要的，他愣了一下就跳过了这里

TCP半连接是什么意思（发生在四次挥手的时候，客户端关闭说明没有东西要发送了，服务器端仍然可以发送），三次握手的时候有半连接吗（没有，因为只有双方established才能通信）

slow start是什么，为啥要slow start（不知道网络是怎么样的，所以要用小包探测，如果直接发大包，那会给加剧拥塞）

看过什么书

有看过什么开源产品/项目的代码吗，如redis、memcached、libevent、levelDB，我说大公司开源产品的源码没深究过，最熟悉的源码可能是STL吧，按照书本内容按图索骥

设计模式知道什么，单例模式怎么实现（双检锁版本or局部静态对象版本），双检锁为何会失效有深究吗（我说在stackoverflow上看到的，但原因是由于操作系统平台引起的，没深究）

现在其他公司or部门面试情况怎么样了

你觉得你自己最大的缺点是什么

遇到最难的技术问题是什么，怎么解决的

如果重来华为比赛，你觉得有什么可以改进的（用C++重写，用冠军队伍的二分发车法）

问我有什么问题，我问了下IM的写扩散在大群的里的问题，这是个我提前准备好的针对问题，C++在钉钉中主要做IM，所以提前了解了IM的一些知识

总结：总体问的不难，很多问题我正好有复习到，所以发挥还不错

## 阿里支付宝网络技术部一面（未选择）

3.11 50min

不愧是搞网络的，对于我的SDN项目很感兴趣，先问我当时SDN比赛的题目，我先给自己了一个台阶，“现在来看，当时的想法不是特别的完善，但是也很幸运的获得了全国一等奖”，然后说明了流量调度算法的场景，部署在域内的接入交换机上，然后说到当时我在武汉华科的决赛现场做方案展示，事先排练过很多遍，展示的时候很不错，评委给了高分，所以获得了全国一等奖

华为的软件精英挑战赛也几乎是我全程在介绍，优化手段，死锁产生原因和死锁，复现调度器，有问到赛制流程、参赛人数这方面的问题

两个项目都问了我在团队里面的定位，负责的内容，收获是什么，技术难点是什么

TCP拥塞控制算法了解多少，非常开放的题目，我从拥塞控制的老版本Vegas、Reno、Tahoe，一直到cubic，再到最近几年谷歌开源的bbr

quic了解多少，非常开放，我说了减少握手时间、避免队头阻塞、在应用层实现这些方面，面试官觉得我说的挺好的

问了我一个模糊不清的场景题：quic和TCP怎么保证传输，用哪个，我说先用ping命令之类的手段去探测网络情况，再根据quic和TCP的特点去选择，TCP是面向连接的，更加可靠，而quic更快

我有什么想问的，quic、bbr在业界使用情况怎么样，5G会不会带来新的发展，面试官从他的角度上给出了自己见解

问我还有其他面试没有，我如实说了

还问我籍贯，正好是湖南老乡，最后说有机会一起共事

## 美团到店事业群一面

3.12第一批笔试，后两题直接输出样例骗了点分，五题加起来算a了两道吧

3.16 15:00-15:40，后端开发，主要写Java，还有一些RPC、中间件、MQ什么的

项目，对惩罚项和死锁比较感兴趣，没有刨根问底，应该是觉得项目做得还可以

CPU调度方法，讨论了一下饥饿现象的产生和如何解决

哲学家就餐问题，怎么解决死锁

对数据库有多少了解，索引的注意事项，b+树和b树的区别

看我比较熟悉计算机网络，从网址输入url到看到页面的过程

总结：感觉很简单的一次面试

## 微软一面

3.18苏州软件开发，11:00-12:00

自我介绍顺带介绍了项目

讲讲ARMA

看我网络还行，问TCP三次握手的过程，为啥两次不行

ARP是啥

手撕代码：输入二维数组vec，行数是交通灯的位数，列数是表示一个数字的晶体管个数（固定为7），vec[i][j]为1表示第i位的第j个晶体管亮了，为0则不亮，但是现在有可能有些晶体管坏了，导致数字残缺，现在给定这样的一个二维数组，求出所有数字的可能（保证输入肯定有解，每个数字至少有一个晶体管是亮的）

首先跟他说了我的想法，先拆分成每一位数字可以转化成的合法数字，然后n位，前后组合即可，每一位数字可以转化成的合法数字可以用回溯算法来做，因为晶体管只有7个，只需要对没点亮的晶体管增加一个分支进行探索即可，最多2^6

最后时间到了，还有格式化输出函数没写，面试官问我回溯算法时间复杂度是多少，因为至少有一个晶体管是亮的，只需要对其他6位进行回溯，所以是2^6，总共n位，所以是O(n*2^6)=O(64n)，当n很大时，可以认为是O(n)

面试完后来想到一个优化手段，把数字与它点亮的晶体管序号做映射，比如1：{5,6}，即数字1只需要点亮第5根与第6根（从0编号），然后读取残缺的数字，假设读到{0,0,0,0,0,0,1}，即只有第6根点亮{6}，可以发现{5,6}包含{6}，所以残缺的数字肯定可以转化为1，再试探能否转化2、3...，10个数字遍历完后，当前残缺的数字能转化成的合法数字就全部找到了，存起来，最后格式化输出

## 美团到店事业群二面（已拿offer）

3.21 16:20-18:20，本来约定是16:15-17:15的，但是面试官上个面试还没结束，所以先扔给我一道题

牛客网手撕代码：大数相加，造了几个测试用例，都通过了，解释了一下代码思路

如何优化你的代码（去掉补零操作），如何改造成浮点数相加（让小数点对齐，整数部分位数少的前面补零，小数部分位数少的后面补零）

17:00 面试官开视频了，进入面试环节

自我介绍

介绍华为比赛的时候扯了围棋的蒙特卡洛搜索以及启发式最短路径算法A*，面试官瞬间懂了我是在做啥

四个项目都简单问了问，坦白电商网站项目是个人学习用的，爬取公众号推文的文本分析项目也讲了讲

问我三大语言的了解程度，还打开了我的简书（其实写的东西都很基础）

数据库怎么优化

场景设计题（30min）：需要存储几个文件，如何用代码实现事务，提交时要注意什么，需要满足事物的四大特性，考虑隔离的级别，考虑锁与并发，问得特别细，而且非常开动脑筋，感觉是没有完美答案的，只是用来考察候选人对知识深度的理解

NoSQL了解多少，我回答知道一些redis和memcached，然后说最近看了篇文章redis的有序集合是用跳表实现

看过什么源码，muduo和c++的STL

你喜欢与他人一起工作，还是独自工作

你如何承受压力，如果工作很忙，你会学习吗

和他人意见不合怎么办

你的优点缺点

喜欢北京吗？上海呢？毕业想去哪个城市？

反问环节，我知道了：

1. 美团事业群是按业务分部门的，比如到店事业群中分为酒店业务线、旅游业务线、餐饮业务线，都是解决实际业务问题的。
2. 统一招聘，发offer的时候再确定部门和岗位，也就是说，现在面我的面试官，以后不一定同部门

总结：感觉二面面试官也是挺友善的一个人，场景设计题的确很烧脑，两次面试都没有问语言，因为知道我是写C++的，操作系统也问的不是很深，计算机网络与网络编程也不是很深，面试的难点恰好就是我最不熟悉的领域——数据库，虽然我也用过MySQL，但是不像Java后台开发那样了解得那么深，况且我也没什么分布式经验，感觉有点面起来有点吃亏。但是还是给我过了。

## 微软二面（已挂）

英文自我介绍 大概3-5min

白板手撕代码：给一个二叉树，输出每层最右边的节点，剑指offer的“按行打印二叉树”的变形，最后用一个测试用例完整地口述了一遍代码流程，顺便问了时空复杂度

反问

总结：几天之后收到了thank you letter，我觉得可能是第一面的代码不是面试官想要的，第二面的代码虽然完成了功能，但是速度又不够快，看了微软面试还是挺难得，需要有很强的算法刷题基础

## 钉钉三面

3.26 睡午觉时的突袭电话面试，23min

我是3.20第一批笔试的，两道题只拿到50分，但考虑到题目偏难，应该可以过，3.26上午看到官网状态从简历筛选中变为面试中，于是在钉钉上问了下hr，她说会安排的，没想到在下午午睡的时候就来电话了。。。

介绍最有收获的项目

饥饿，如何解决，多级反馈队列

悲观锁和乐观锁，扯了下乐观锁的实现（版本号和CAS），原子操作啥的，乐观锁的写时检查会不会有问题

一个进程对全局数据修改，另外一个进程看得到吗，扯了一些寄存器、内存地址、volatile啥的

进程与线程的区别

malloc和mmap的区别，映射区是什么（强调了一下是C语言的内存模型）

解释事务的ACID

MySQL的四种一致性（没答上来

一条MySQL语句执行过程（没答上来

总结：本来以为第三面是交叉面的，可能是为了完成总共五面的流程，插进来一次简短的面试，我可以感觉对方没有想多花时间面试的欲望，他说结束的时候，我愣住了，问就完了吗，对方说是的，前面已经有两轮了

## 钉钉四面（交叉面）

3.27 14:08-15:03

为什么这个时间要记这么清楚，是因为我在3.27中午接到了心心念念的腾讯HR面试邀约3.27 15:00，所以想着小憩一会再迎接HR面试的，在睡梦中突然来了个杭州电话，钉钉四面（交叉面）来了！一边接电话一边起床，慌慌张张的，首先明确跟面试官说三点之前要结束，他说没问题，于是整个面试他的语速都非常快，问题一个接一个，以下记录可能不太完整

项目

手写代码match，用C语言写，不能用容器

刚才这个手撕的函数，返回值是int*，在栈还是堆，为什么

vector在栈还是堆，能开10万个元素的vector吗，怎么扩容的，怎么开辟内存，vector作为函数返回是在哪，有什么要注意的（这里回答的不好，我最开始回答的是在堆上，但面试官问到vector作为函数返回在哪时，我又把答案改成了栈上，还说会有爆栈的风险。其实vector就是在堆上的，底层由allocator去维护，所以函数退出时，普通定义的vector也可以由allocator自动回收）

gdb调试，开启什么参数，切换线程，切换栈（只知道用bt打印栈），打印参数时被优化了是怎么回事（不知道）

看过啥开源项目（陈硕的muduo网络库）

写完代码后，有什么优化手段（我以为是在写代码时注意优化，他说不是的，我回答不会了）

全局变量可不可以在头文件中定义，为什么不行（应该是不行的，但是原因我不知道，我扯了一会extern，然后说不知道，正确答案见[能不能在头文件中定义全局变量？](https://blog.csdn.net/baidu_35679960/article/details/79200865)）

topk问题，基于partition的快速选择算法的时间复杂度为什么是O(n)而不是快排的O(nlogn)（不是分治而是减治，等比数列求和可以知道是O(2n)，省略系数就是O(n)了

数组中所有数都是成对的，只有一个数落单了，找出它（异或，只需O(n)时间复杂度）

Q：看来你有所准备啊（指的是两个算法题）

A：啊没有没有（一顿傻笑）

Q：你觉得你的优点是什么，你觉得这次面试你发挥得怎么样

A：巴拉巴拉，发挥得不是很好

Q：你认为你的代码能力在班级排第几

A：班级50来个人，我觉得能在前五名吧

Q：但我感觉你的手撕代码不像是前五名的水平

A：可能是因为有点紧张

Q：你确定你是因为紧张，还是因为能力没那么强？

A：紧张

Q：但我觉得你在vector那里不好

A：不好意思，可能这块知识我不是很了解

Q：你有什么要问我的吗

A：因为我的问题基本上在前三个面试官都问过了，所以没有其他问题了

Q：好的，那就这样，谢谢，拜拜

总结：代码能力排前五名我是吹的，还真不一定，交叉面压力也是有的，有些知识点不是很清楚，还需要再加强

## 腾讯TEG HR面（已拿offer）

3.27 中午收到下午三点HR面试邀约的邮件，于是打算小憩一会，在睡梦中突然接到一个来自杭州的电话，阿里四面来了！好不容易面完，挂完电话的一分钟之后，广东电话就来了。

3.27 15:05 本来约好电话面试，但是由于通话不清晰，改为了在腾讯会议不开视频的通话面试，以下A是本人

看你的比赛经历比较丰富，你是怎么看比赛的呢

A：因为在校学生参与实际大型项目的机会比较少，比赛是个很好的选择，能锻炼编程能力，也能锻炼解决问题、分析问题的能力

那为什么不来实习，而去比赛呢

A：腾讯要求比较高，为了打好基础，提高自己，所以我选择了打比赛，而且当时也没系统地复习过后台开发相关的知识，所以还是继续学习，参加比赛，提高自己

说说华为比赛

A：巴拉巴拉

比赛的分工是怎么样的呢

A：我是队长兼主程，队友辅助巴拉巴拉

华为比赛过程怎么样的，有遇到什么技术之外的难题吗

A：巴拉巴拉（团队合作）

嗯。看得出来这个团队合作对你来说是难忘的记忆

在长达两三年的科研项目中获得的最大收获

A：思维模式，发现问题-分析问题-解决问题，巴拉巴拉

（好像很认同这个思维模式）你在什么时候发现自己掌握了这个思维模式呢

A：直接举了华为软件精英挑战赛的例子，从分析题目，到提出问题，用优化手段解决问题，再到碰到技术难题，再集中攻关，最后收获成果，这个成就感是很强的，巴拉巴拉

你没有互联网大厂实习经历，如何理解互联网后台岗位

A：虽然没有实习，但是有很多了解，通过前面几轮技术面，我相信我的后台知识储备也是过关的，我也非常想进腾讯互联网公司，互联网公司主要是做产品与服务，像腾讯这种大体量的公司，产品要服务于万千用户，那为了提供更加优质的产品与服务，就需要技术人员的分工合作，前端后台等等，后台的方向有很多，数据库、服务器，我相信腾讯肯定用的是最好的硬件资源，但再好的设备也要交到人的手上才能发挥优势，后台就是做这样的事，我们要做的就是最大化利用硬件资源，为产品与服务提供基础保障等等，巴拉巴拉

你讲的挺好的，很有主持人范，我都被你带进去了

A：我以前做过主持人，所以说话这方面还算不错

实习时间

A：三个月没问题的巴拉巴拉

你有什么问题呢

A：大概什么时候有结果

几个小时后去官网查询状态即可，如果是已完成，就等offer审批，审批需要两三天，大概下个星期会有结果

A：我会和我的内推师姐在同一个部门吗

（查了一下电脑，发现我的面试官也是同一个部门），可能会

A：我觉得如果有很熟的直系师姐带我的话，我会成长得更快

不用担心，我们会安排导师，都很nice，而且我相信你的沟通能力，肯定可以可以成长得很快的。最后有没有面其他公司

A：投了一些简历（但我最想进的还是腾讯，我忘记说这句话了！）

总结：14:08-15:03刚面完钉钉四面（交叉面），P9大佬还让我手撕代码，问了很多东西，因为知道我三点要结束，所以语速很快，我觉得我发挥得不算太好，在听腾讯HR说话的时候，还偶尔还有点走神，思绪还没有完全从半个小时前的一些问题中出来。所幸HR小姐姐很温柔，说话轻声细语，很快我也冷静了下来，开始发挥出我应该有的水平。从3.2一面，到3.6二面，再到亚历山大的3.10三面，以为自己在总监的连环炮下要凉了，但内推师姐说我过了，但是简历一直没更新，3.19，我的状态变为了初试，当时心灰意冷，师姐问了HR，说要么凉，要么转组，但3.20下午又变为了复试，感觉峰回路转，晚上又变为了HR面试，我心情激动，一直等啊等，终于在3.27中午接收到了面试邀约，许愿offer！

4.1 17点，在撸铁的时候来了个电话，广东深圳，座机号码，oc来啦，两个小时后收到了录用函，感谢tx爸爸收留。

## 美团HR面（已拿offer）

3.27 70min

300RMB/天，一个月房补1500

## 钉钉HR面

3.28 1h

项目

成绩

英语好吗，真的好吗

家庭情况怎么样

分享一下最初不擅长，但是迎难而上的事情

你到底想成为什么样的人，具体画像

你喜欢什么体育锻炼

目前为止，坚持得最久一件事情是什么

参加什么健身项目

健身的难点和阻碍是什么，坚持很难吗

最印象深刻的收到批评的事

作为组织者完成的团队任务，分享一下

比赛取得成绩最关键的因素是什么

所在行业的动态，以及竞争对手的动态（钉钉、企业、飞书啥的）

过去两年，遇到最棘手的问题

复盘项目，有什么改进空间

团队协作有分歧、最后达成一致，分享一下

同学对我的印象，有什么负面的吗

你通过什么途径来学习技术

有在开源社区发表过什么吗

有论文吗

现在最佩服的人是谁

总结：一个小时的密集开放性问题，很难顶。。

## 虎牙一面

3.31 电话 1h

派生类=子类，父类=基类

看过什么C++书

后台开发是什么，与项目关系强吗（最后面试官说现在互联网公司不缺钱，买了大量的硬件，不需要人力那么强，可能跟我想的后台开发不太一样）

extern是什么---extern在变量前、extern "C"在函数前

Q：extern "C"在什么场景下使用

A：不需要虚函数重载的情况

Q：这是为了用而用，有没有不得不用的场景

A：只支持C编译器的开发环境下？

Q：那根本没法编译cpp了嘛，其实答得差不多了，当C++要作为库文件给C去调用时，不得不用

重载与覆盖有什么区别---重载的定义、覆盖的定义

Q：如何调用非虚的重载过的父类函数

A：static_cast可以吗

Q：emmm 这是一种方法吧，怎么样避免覆盖呢？

A：C++11支持的final关键字

Q：emmm final是避免虚函数进行重写吧？你可能没理解我的意思，父类有个非虚函数，我想在子类实现一个同名函数，但又不想覆盖父类，我想实现一种重载的机制

A：那我把这个返回值修改一下可以吗

Q：恐怕没有关系吧。emmm没事，想不起来就算了，这是比较生僻的语法。

析构函数为什么要声明为虚函数---内存泄漏

Q：在什么场景下没法析构呢

A：定义指向父类的指针，但是指向派生类，如果析构函数不是虚的，那么delete这个指针时，派生类的独有资源无法析构

Q：什么情况下派生类没有多余/独有资源

A：派生类没有自己定义新的数据成员，又没有重写虚函数

Q：如果重写了父类的虚函数，就会有多余的资源吗

A：对，因为重写虚函数，虚函数表要更新，而且派生类对象有一个虚函数表指针

Q：如果子类没有自己定义新的数据成员，只是重写了一个虚函数，那么它的内存体积会比父类大吗

A：emmm 应该是一样的，数据成员是一样的，非虚函数不占用类对象的内存空间，而父类与子类都有一个虚函数表指针，也是一样的

Q：如果在父类的虚析构函数中调用了虚函数，子类重写了这个虚函数，那在析构时，父类的析构函数中执行的虚函数是父类的还是子类的？为什么？

A：父类的，一般来说，在析构函数不应该调用虚函数，因为没法体现多态性，在析构时，顺序是先析构子类再析构父类，所以当执行基类的析构函数时，子类已经析构完了，所以虚函数只能是父类实体的

Q：子类没有重写父类的函数，但子类有自己的一些内置类型，如果父类的析构函数不是虚函数，那会产生内存泄漏吗

A：应该不会，巴拉巴拉（乱扯，什么堆空间）

Q：（拉回主线）我要delete一个类，类中的成员变量都是在堆上的，你再想想

A：（沉默了10s）我总觉得不会产生内存泄漏，可能是因为有什么内存回收的机制吧

Q：OK，那分析一下delete的过程

A：先析构，再回收空间

Q：用哪个函数回收呢？

A：delete operator - operator delete - C的free函数，牵涉到底层内存管理，

Q：free要指定长度吗

A：不用

Q：这是不是就是上一个问题的答案呢？

A：（恍然大悟）哦~所以这些成员变量相当于向前在类里面，在free类对象的时候也回收掉了

vector与list的区别---从连续内存与非连续内存的角度分析了一下性能

Q：vector当capacity不够时，需要重写申请空间-copy-销毁旧空间，这个时间复杂度是多少

A：单这个行为是O(n)

Q：那为什么push_back是O(1)呢

A：摊还分析，前面经历了很多次O(1)的push_back，这次O(n)push_back可以把时间摊还到前面去，所以整体是O(1)

Q：如果出现扩容，原本迭代器会失效吗，为什么？

A：vector迭代器底层是原生指针，指向原来的地址，扩容后需要搬运，所以原来的地址失效了

Q：那如果要你重新设计vector的话，要怎么样才能让迭代器不失效呢

A：迭代器中除了原生指针，还需要加入相对于begin()的偏移量

STL map底层是啥，为啥选红黑树不选AVL树，AVL树插入和删除最坏情况（O(n)），为什么不用B+树

Q：你说的B+树在数据库场景下能减少IO次数，应该指的是能减少IO次数，那如果是SSD有什么不同

A：（我的天，这是啥问题）这个。。。不太清楚

Q：那换个问题，SSD与机械硬盘的优缺点

A：（不是很清楚SSD的原理）SSD好像是什么二极管，有很多格子，用电激活起来，比较脆弱，随机读写性能更好。机械硬盘的随机读写性能比较差，因为它是有磁头的，磁头要去寻道，这牵涉到很多寻道算法，比如电梯算法，但是还是要移动磁头，所以性能较差巴拉巴拉

Q：emmm 差不多吧，不是因为SSD太强，而是因为对手太弱了

STL内存配置器有重写过吗（没有）

进程与线程的区别，线程私有变量是什么（回答不清楚，面试官说这是很关键的一个点，复盘时我才听清是thread local storage线程局部存储，不过我也不会）

多线程与单线程的优劣

STL容器是线程安全的吗（不是），有什么需要注意的（加锁与同步）

Q：多个线程读vector的内容需要加锁吗

A：不需要

Q：如果很多线程读，一个线程写，用什么锁比较好

A：读写锁吧

Q：读写锁有两种设计方式，一种是写优先、一种是读优先，写优先怎么做

A：写的时候，加锁，排斥其他的读

Q：读优先呢？

A：多个线程都能读，一个线程写的时候加锁

Q：emmm 读写锁本来就是要这样的（沉默了一会）OK吧，下一道题

C++11的atomic有听过吗（有），有几种内存模型（不知道）

服务端用accept，成功返回，说明三次握手完成了几次

A：（没搞懂他的问题，僵了好久）三次吧

Q：emmm ok，如果已经建立连接，那客户端如果连续发三次100字节的TCP包，那服务端有哪几种可能性呢

A：首先看不需要分片，100字节小于互联网场景的MTU，不需要分片，如果在不丢包的情况下，会收到三个包

Q：有没有可能收到一个300字节的大包

A：有可能，TCP是面向字节流的，服务端不知道消息的长度，在接收缓冲区读一定长度的字节，所以需要做粘包的处理

回到项目，华为比赛，可以用分布式吗，考虑一下

有写过分布式程序吗（没有），有了解分布式吗（知道CAP定理），现实中选择CAP中的哪项丢弃（A不能，CP看情况），什么情况下把P舍弃掉（我听错了，回答NoSQL把P舍弃掉了，复盘时才知道答非所问，面试官没说什么）

## 虎牙二面

4.2 牛客视频，45min

项目

STL容器有哪些（按照STL源码剖析的顺序讲了一遍）

Q：红黑树和哈希表，什么场景用呢

A：有序无序，时间复杂度（查找、插入/删除）、哈希表内存更大一点（一般是数据总量N*2，而且是质数）

Q：既然提到了内存，epoll里面是啥数据结构，为什么呢

A：红黑树，epoll_ctrl需要经常插入或删除，红黑树可以以更稳定的Ologn时间复杂度，哈希表在不断插入时可能需要rehash，在不断删除时原先开辟2N空间又会大大浪费

Q：emm这是内存的消耗，那我举个例子，假设TCP连接有十万个，内存消耗有多少呢？

A：单单一个TCP连接只消耗一个文件描述符fd，一个TCP连接有接收缓冲区与发送缓冲区，内存单位可能是K，取决于具体实现

Q：emm 是的，内存这也是一个点，但是在小场景下，哈希表浪费的内存也没有太大，有没有更重要的关注点

A：在时间上，哈希表可能需要rehash，红黑树在插入和删除后，最多两次还是三次就可以达到平衡，更加稳定

Q：emm 还有没有其他的点，可以影响到你红黑树与哈希表的选型呢

A：emmm

Q：工程上就是不断地取舍，再想想

A：（一番思考）我想到了一种场景，类似于数据库要用B+树的原因，要进入哈希表的数据需要经过哈希函数，可能会散落在哈希表各个地方，没有规律；红黑树是一种有序结果，相似的项目就在附近，所以遍历查找会更快一点

Q：（分析了一通）不是很确定，回头可以验证一下。其实还有个很重要的点，你没想到，那就是重载的问题，可能这个数据根本无法比大小

A：哦~嗯。。。那这个可能也算在有序无序的区别里面？

Q：也就是operator < 压根不能使用，这个时候不能用红黑树

A：哦~对对对，有道理

进程与线程的区别（巴拉巴拉，还说了一面完后学的thread local storage）

Q：（当我说到线程有自己独有的栈段与寄存器时，打断）为什么线程会有独有的寄存器，放在那里？

A：噢噢，我说的是程序计数寄存器

Q：emm 那放在哪里呢，比如我开一万个线程，就有一万个寄存器跑出来？

A：CPU里面吧，可能是L1 L2缓存里面，当我要调度下一个线程，就从缓存中把相应的程序计数寄存器读取出来（我的说法容易引起歧义，寄存器是一个个物理的、真实存在的元件）

Q：（解释了一通）寄存器应该是轮流占坑的东西

A：是是是是，我是这个意思

Q：有听说过协程吗

A：交织式的子程序，C++20，微信开源了协程库libco巴拉巴拉，具体怎么实现与应用场景坦白不是很清楚

Q：你说到了C++20，你对C++的新标准有什么了解呢

A：C++20有个Ranges，是对于区间范围的升华，好像传入泛型算法里的参数可以有更多的范围形式，巴拉巴拉，具体有点忘了

Q：如果想做左开右闭怎么办

A：把begin和end往前移一下

Q：ok 这不是很重要的事情

Q：条件变量为什么要传入一个锁，为什么不放在内部呢，就像printf一样，对缓冲区加锁解锁，用户不需要关心

（一来一回聊了很久，我始终没有答到点上，但是竭尽全力把自己的知识都吐出来了）

TCP与UDP的区别（我讲了很多很多，聊到自己搭建服务器用了bbr拥塞控制算法什么的）

Q：DNS为什么用UDP

A：包更多、对网络消耗更大、时间更多

Q：http dns有听过吗，就是用http来实现dns

A：（刚开始没听懂，解释了一番dns）哦。。是用http来做dns，没听过

Q：P2P，你觉得用TCP和UDP

A：我想想，点对点，我觉得是TCP吧，因为传输很大的字节流，要保证完整，所以我觉得是用TCP做的

Q：但是其实是用UDP做的

A：（尴尬）啊这样子的嘛。。（傻笑）

虎牙直播，弹幕的字数是1-30个字，后台有100w个敏感词数据库，怎么样实现屏蔽效果，注意是包含，可能有几个字是敏感词，也需要屏蔽

A：分词巴拉巴拉，nlp巴拉巴拉，布隆过滤器巴拉巴拉，哈希表巴拉巴拉

Q：分词属于nlp范畴了，感觉有点太过了，我想问的是nlp的一个子问题，而且我想要的是包含逻辑，不是匹配逻辑（特指布隆过滤器）

A：kmp算法？巴拉巴拉

Q：那得运行很多遍，不用这么复杂

A：（想了一会）好像在搜索引擎中，可以联想关键词，好像用到了一种叫做什么trie树来着

Q：那怎么具体怎么解决的呢

A：emm 具体有点不太了解

Q：ok我没什么问题了，你有什么问题可以问我

A：我想问一下刚才这道题，您最期待的答案是什么

Q：emm 这有很多种解法，有挫一点的也有高大上一点，比如AC自动机，树，或者自己构造一个树，trie树什么的

A：那虎牙直播是怎么解决的呢

Q：最开始我写的一个版本是用到了类似的，后来用了AI，现在还支持拼音，还有更多的组合，你可以自己写一写，挺有意思的

A：您觉得我还有什么提高的吗

Q：基础还可以，有些点没答上来（觉得我p2p那里没回答出来有点可惜），其他的还好

总结：面试官很友好，整个面试像一场技术探讨，很多东西我可以自由发挥，我说的一些点，面试官也在思考，感觉不错

半小时后HR电话，通过二面啦

## 虎牙三面

4.3 电话 15min

为了找C++后台开发岗位，你做了哪些准备

项目做了什么，有什么收获（每个项目都聊了一会）

网络编程了解多少（看了UNP、APUE，还看了陈硕大神写的Muduo网络库，但由于时间关系没来得及自己造轮子，巴拉巴拉）

半小时后HR电话，通过三面啦

## 虎牙HR面（已拿offer）

4.3 电话 15min

为啥投虎牙，啥时候看虎牙直播的，对虎牙有其他了解吗

有投其他公司的吗，怎么抉择

啥时候能来实习

## 网易互娱一面

4.10 平台研发（技术中心），偏网络，跟我挺对口的

对华为比赛项目丝毫不关心，直接打断问我的SDN大赛&&科研项目

你的转发层用的什么（ovs）

ovs流量转发方式有了解吗（我答了普通SDN的转发方式）

ovs转发的快速通道与慢速通道的区别（这啥问题？完全没听过）

ovs底层有啥了解吗（QoS流量整形用了令牌桶算法）

令牌桶的原理（巴拉巴拉）

如何用代码实现令牌桶算法（类似于生产者消费者模型，用队列），加令牌怎么做（以一个恒定速率取走队列头），如何恒定速率（定时器），时间轮和最小堆定时器的区别（巴拉巴拉），时间轮和最小堆定时器插入定时事件的时间复杂度(O(1)和O(logn))

还有其他了解ovs的东西吗（没有

有了解过转发面开源的组件吗（没有

控制器用的是哪个（ryu），有对比其他控制器吗（ryu与floodlight），ryu的架构（我只记得eventlet什么的，本科研究过，上研究生后没有研究这么底层了），ODL有了解过吗（企业级控制器），OVN有了解过吗（没有）

科研是什么，解释一下，具体是怎么做的（Mininet xterm运行GUI脚本，调用自定义的REST API与控制器通信）

-----常规问题------

软链接与硬链接

进程创建子进程的流程（fork、共享虚拟地址空间、写时拷贝、exec族函数执行新的程序映像、僵尸进程、父进程需要回收），操作系统对于进程号的限制（取决于OS版本，一般是1024个，具体可以用ulimit查询，或者修改内核文件），如何解决僵尸进程（父进程创建信号处理函数捕捉SIGCHILD信号，里面调用waitpid）

在开发中，有没有过深入了解原理然后解决问题的经历（不算问题，算好奇，探究了一下*i++的汇编实现，还写了篇简书）

编程时有没有用过锁，具体什么场景（两个线程交叉打印，互斥锁+条件变量，一个线程打印完notify另一个线程，如此循环），notify是什么锁（条件变量，传入的是互斥锁）

自旋锁是啥（巴拉巴拉）

你前面提到你会由于好奇心驱使去看汇编，那锁的汇编有了解过吗（没有

---另一个面试官---

ARP协议怎么工作的（巴拉巴拉

ARP跨网段与同网段有什么不一样（这个问题搞了好久，始终没答在点上。我说要用ARP去找网关IP地址，但其实是由用户手动填入网关地址的。。面试官一直在给提示，但我不是很懂在问什么，最后他告诉我正确答案是：根据下一跳知道是跨网段还是同网段，如果是跨网段就不用ARP协议了）

请求外网服务器的HTTP服务，比如www.163.com，可以说说整个过程（问题描述很拗口，其实就是问：浏览器地址栏输入一串www.baidu.com，回车后到页面出现，这段时间发生了什么）

总结：第一次面这种网络岗的面试，面试的知识点很多都挺冷门的，比如ovs只要搞SDN的人才知道，也算是增长见识了吧

## 百度一面

3.29号晚上笔试的，当天下午有网易雷火的4h笔试，但是因为头天晚上熬夜，所以就翘了网易雷火的，参加了晚上的百度笔试。题目都忘了是啥，做的一般般吧（笔试的编程题是我的弱项）。

百度这次是统一组织面试，安排在周末，不是部门直面，可能会根据简历、面试表现、个人技能，三面后再分配部门。
按照我的往常经验，面完一轮后会再约时间第二轮，而百度招聘又说实习生面试在四月的三个周末，所以我以为第一个周末一面，第二个周末二面，第三个周末三面，没想到一天搞完三面。我约的是4.1 11:00-12:00，三面完的时间是14:20，中间吃饭花费了15min。早知道如果是这样紧凑的流程，我就预约下午的好了。。

4.11 C++开发 50min

项目，问了下华为比赛流程

华为比赛是偏算法的，为啥不找算法岗

为啥本科没实习

Q：常用STL容器

A：vector，支持下标，内存连续，resize，capacity，摊还分析push_back

Q：vector与list元素个数相同，遍历一遍，哪个快

A：vector更快，list需要指针，vector是连续内存，因为有L1L2L3缓存，可以更快

Q：为什么更快

A：缓存层级，金字塔，经常使用的话放在更上一层缓存，读取就更快

Q：CPU高速缓存的逻辑

A：经常使用的数据放在更高的缓存，如果在缓冲中没找到，就用LRU这种缓存置换算法

Q：unordered_map与map

A：红黑树，特殊的BST，有序

Q：（打断）红黑树是啥结构

A：巴拉巴拉

Q：与AVL树的区别

A：AVL是严格平衡，旋转可能更多，红黑树的优势在于稳定性，插入和删除都是O(logn)

Q：说说哈希表

A：哈希冲突，开链法，开放地址法，退化成链表，装载因子，质数，rehash巴拉巴拉

Q：如果哈希函数很烂，很多元素挂在一个槽的链表里面，有什么优化措施吗

A：不用链表用红黑树

Q：开放寻址法怎么删除元素

A：不能直接删，得做个删除标记

Q：如果删除了很多元素怎么办

A：重新哈希一遍（重新再插一遍）

Q：还知道其他的数据结构，插入与删除效率比较高

A：跳表巴拉巴拉（根据极客时间的知识点说的）

手撕代码：实现String（推荐陈硕大神写的[面试中常见的string的写法](https://coolshell.cn/articles/10478.html)

信号量与条件变量的区别

Atomic内存序（不太记得了）

你还知道什么了解的比较深的（拥塞控制算法bbr巴拉巴拉

在一个函数调用前后打印时间戳计算时间，一个函数调用内第一行和最后一行打印时间戳计算时间，如果两种时间相差很大，有什么原因（以为是函数栈帧方面的底层，但其实是拷贝传参，析构局部变量可能很耗时）

总结：不算很难，很多问题我都可以展开讲很多。最后一个问题挺有意思的，面试的时候没想到，面试官还提示说你肯定知道，但是忘记了。最后评价我还是挺优秀的，除了一些细节，等一下就去二面吧。

## 百度二面

4.11 50min

个人介绍

条件断点和打日志是怎么操作的，举个例子（官方给了一个通过线上调度器打印的日志，里面是每一秒全地图的道路信息，我用自己复现的调度器，与它diff，发现在第1000行，在road_id=2000的道路，第15号槽，两个日志不一样，于是就可以在IDE中做条件断点巴拉巴拉）

网络分层模型（OSI七层，也有四层的说法，但一般说五层）

TCP与UDP是哪层，有什么区别（巴拉巴拉

如果传输文件用TCP还是UDP（想可靠就TCP，想快速就UDP

如果UDP怎么做简单的可靠传输（我说校验和，他说行

HTTP在哪层，HTTPS多了什么（TLS握手，交换非对称密钥，巴拉巴拉

加密算法了解多少（对称、非对称、签名巴拉巴拉

指针与引用的区别

内存中，堆和栈的区别，底层是什么数据结构，栈的最大值是多少

new和malloc的区别

delete和free的区别（与new和malloc差不多，C中malloc和free是一对，C++中new和delete是一对，delete先析构对象再回收内存，里面会调用free）

手撕代码：

1）面向对象，写三个class，动物、狗、猫，你自己发挥（访问控制权限符、virtual、多态、虚析构巴拉巴拉，然后解释了一下）

重写和重载的区别，在刚才的class里随便实现一下重载

2）写个二分查找的函数，用main函数调用，一次性work了

总结：也不算特别难，挺基础的问题，这时候已经一点多了，让我先去吃个饭，然后三面

## 百度三面

4.11 35min

自我介绍

static关键字与public与private的区别（这完全是两个范畴吧。。一个是修饰静态，一个是访问控制修饰符，全部解释了一遍）

public与private的区别（公开、私有巴拉巴拉）

new，先执行父类构造还是先执行子类构造（先父类再子类）

父类与子类的函数名可以相同吗（虚函数用同名函数可以实现多态，非虚会重定义）

重载与重写的区别（二面刚问过。。）

手撕代码：给你一个每行包含url的文件，统计出现最多的10个url

我不太记得文件操作的API了，string的分割也忘了，最后允许我化简成了关于url的数组，我先是用map记录了每个url与其出现的次数，然后构造一个最大堆（后来才发现我构造的是最小堆，cmp那总是记反-_-），堆元素是一个pair，记录着url与其出现次数，自定义了比较函数，比较出现次数（也就是pair的第二项）

说说冒泡排序、快速排序、堆排序在这种联机情况下的区别（也就是一边输入，一边得到当前的topk）

比赛中你的角色是什么，人员有流失吗

对数据库熟悉吗

对Linux熟悉吗

比赛是偏向于创新性、演示性还是工程应用？

总结：第一次三次面试连在一起，中间只用了十五分钟吃了个午饭。虽然每轮都有手撕代码，但都不难，也有可能时间限制，没法出太难的算法题，问的问题也偏向于基础，还是挺轻松的。

## 网易互娱二面

4.18 40min

面试官开场就说我们是校友，做过几年面试官，问我学校里为啥都没人研究SDN的

全程问项目

负载均衡思想，具体算法（我说取决于具体场景），负载均衡的隧道模式等等知道吗（没听过）

说说一致性哈希

你怎么知道这些课本里没有的知识的(通过书籍、博客巴拉巴拉)

怎么检测报文是异常的（持续发短连接，拒绝式攻击，ARP攻击，中间人攻击，SYN FLOOD

时延和带宽检测怎么做的

通过packet_out检测三段时延，通过echo检测channel时延，有可能链路发生急剧变化，可能三段时延比channel时延还小，怎么解决（临时想的，用一个包即可，交换机回复echo+转发LLDP，具体通过ovs的流表的action实现，面试官说这种可以，还有一种方法下发packet_out时，每到一个交换机就打一个时间戳，最后回到控制器就通过时间戳计算链路时延）

Ryu不支持控制器集群，有没有考虑怎么支持吗（没有，解释说当时的场景，控制器不会出现瓶颈，就没研究了

ovs的底层有了解过吗（说了QoS的令牌桶算法

令牌桶某种程度是buffer，令牌桶是否越大越好，抛开计算机的内存限制（没答上来，后来面试官告诉我，如果buffer太大，最后进来的包可能要很久之后才能转发，这就产生巨大的时延，如果buffer很小，则很快就可以转发，但是有可能丢包，所以取决于当前场景是容忍丢包但时延敏感 or 时延不敏感但不能丢包，这题还得分场景答，实在没想到。。

总结：对项目挖掘的还挺深的，所幸大部分都是我知道的，两个发散问题只答出来一个，挺难想到的。最后夸我两个项目研究得挺深入的。还有一些关于实习时间的问题，就没记录了，网易私有云，计算 网络 存储都有，团队氛围open

## 字节提前批一面

产品研发和工程化部门

7.26 14:00

个人介绍3min

针对项目提问20min

先问我哪项了解多点，我说计算机网络，然后面试官说那先问一下简单的操作系统吧（-_-

---

进程线程协程区别

A进程可以访问B进程的空间吗（不能

那怎么能访问呢（IPC

共享内存咋实现的（直接把物理地址映射到另一个进程的地址空间里面去

为啥共享内存快（省略了用户态到内核态的开销，追问还有吗，回答其他的不了解了）

---

TCP三次握手，服务端如果不调用accept会咋样（客户端发完第三次的ack包后就认为自己建立连接，而服务端不认为

那为什么会有这种状态不一致呢（拜占庭问题

TCP是可靠的，三次握手能解决什么问题呢，用你的观点来说好像不是可靠的？（建立连接的确可能出现这种问题，但是客户端第一次发包的时候，服务端认为连接不存在，返回一个RST包，这样客户端就知道连接不存在了

那我换个问题，TCP双方确立连接后正常发送数据，如果服务端突然崩了，那会咋样（客户端认为连接还在，服务端认为不存在，返回RST包提醒客户端

假设服务端进程core了，或者机器坏掉了，这两种有区别吗（第一种是返回RST包，第二种不会有任何响应，客户端会重试几次，然后认为连接失效

RST包是谁发起（服务端

是指这个进程还是这个机器呢（应该是这台机器吧，因为这个进程已经core掉了

那你知道这个包的协议是什么，就是它在哪一层（RST包就是TCP包吧，那不就是在传输层？

连接都断了，为什么还有这个包发送呢（我回答的是Linux TCP协议栈可以处理这种问题，我没有这个连接，莫名其妙接收到了这个连接的包，所以会回一个RST包

你意思说这还是一个TCP包是吧（对

面试官沉默ing，这让我产生了怀疑，RST包不是TCP包嘛？

---

共识算法了解哪些呢（paxos、raft、gossip，前面稍微连接一点

raft大概是咋样的逻辑（更好实现更好理解，leader、follower、candidate，相比于paxos，选主和日志复制分离，模块化，paxos的proposer和acceptor把选主和日志复制糅合在一起了

你知道它是怎么解决网络分区的问题（脑裂的问题，一半以上的支持才会确认自己leader，好像是通过item的index来决定谁的leader程度更高，另一个就自动退化为follower

---

C++虚函数说一下

如何取到子类的函数地址（虚函数表其实是个数组，对虚指针解引用，然后用中括号

---

MySQL索引（B树、B+树

为啥用B+树（减少磁盘IO次数，区间遍历

写性能相比于读性能（要差，因为要分裂和合并分支，来维持m阶的特性

---

下面的输出

```c++
class C {
        public:
            // int a;
            void func(void) {
                printf("hello %d", a);
            }
    };

    int main() {
            C *c = NULL;
            c->func();
        return 0;
    }
```

我首先说是会报member access null类似的错，然后面试官让我跑一下，啪啪打脸。。

再分析一下？（想了一会，推断说func是非虚的成员方法，所以可以直接访问

那怎么找到func的地址，或者说这个函数是放在哪里的（代码段

如果加上一个int a成员变量，会输出什么？（先想了一会，开玩笑说对自己的答案不是很自信，我首先说会输出0，然后再改口说会报错，原因是func调用了成员变量，成员变量需要访问类的对象，而c没有new出来，所以会报错，大概是对的

---

用rand 7 实现 rand 10

---

有一个无序整型数组：[3, 7, 2, 0, -1, 9, 8 ...]，长度1000w左右，要求设计一个算法，找到数组中位数

先说了大小堆的联机解法，然后面试官说想要小于O(nlogn)时间复杂度的排序，对数组元素没要求，也不需要额外空间

这里我们的沟通出现了问题，我以为面试官是想要完全排序，然后说了桶排序什么的，但他原意是找到中位数就行，害，那就直接进入主题：快速选择

14min左右撸出来了，没时间debug，跑出来是死循环，然后时间也差不多了，大概说了一下思路，差不多解释清楚了

```c++
#include <iostream>
#include <vector>
using namespace std;

int quickSelect(vector<int> &vec, int l, int r) {
    if (l >= r) return l;
    int pivot = l; // 选择第一个为枢纽
    ++l;
    while (l < r) {
        while (l < r && vec[l] < vec[pivot]) ++l;
        while (l < r && vec[r] > vec[pivot]) --r;
        swap(vec[l], vec[r]);
    }
    swap(vec[l], vec[pivot]); // 枢纽归位
    return l; // 将pivot返回
}

int findMedium(vector<int> &vec) {
    int n = vec.size();
    int l = 0;
    int r = n - 1;
    int k;
    while (true) {
        k = quickSelect(vec, l, r);
        if (k == n / 2) { // 找到中位数了
            return vec[k];
        } else if (k < n / 2) {
            l = k; // 中位数在右边
        } else {
            r = k; // 中位数在左边
        }
    }
    return -1; // never reached
}

int main() {
    vector<int> vec {3, 7, 2, 0, -1, 9, 8};
    cout << findMedium(vec) << endl;
}
```

## 字节提前批二面

17:00-18:30

项目

钉钉实习 分布式词典

腾讯实习 trigger io

elk、日志的难点，采集日志的进程挂了咋办，日志rotate后咋办

c++内存模型（高字节到低字节整了个遍

malloc的底层实现（brk与mmap

虚拟内存

io复用

tcp拥塞控制

题目：二维数组的地图中，搜索指定字符串是否存在

同力扣79，力扣79还加了限制条件，已经走过的单元格不能再走，得用visited数组记录

```c++
#include <iostream>
#include <vector>
using namespace std;
bool dfs(vector<vector<char>> &board, string &word, int wordIndex, int x, int y) {
    if (board[x][y] != word[wordIndex]) {
        return false;
    }
    if (word.size() - 1 == wordIndex) {
        return true;
    }
    wordIndex++;
    if ((x > 0 && dfs(board, word, wordIndex, x - 1, y))
        || (y > 0 && dfs(board, word, wordIndex, x, y - 1))
        || (x < board.size() - 1 && dfs(board, word, wordIndex, x + 1, y))
        || (y < board[0].size() - 1 && dfs(board, word, wordIndex, x, y + 1))
        ) {
        return true;
    }
    return false;
}
bool exist(vector<vector<char>> &board, string word) {
    for (int i = 0; i < board.size(); ++i) {
        for (int j = 0; j < board[0].size(); ++j) {
            if (dfs(board, word, 0, i, j)) {
                return true;
            }
        }
    }
    return false;
}
int main() {
    vector<vector<char>> map;
    vector<char> vec = {'a', 'c', 'd', 'z'};
    map.push_back(vec);
    vec = {'x', 't', 'r', 'o'};
    map.push_back(vec);
    vec = {'f', 'i', 'o', 'o'};
    map.push_back(vec);
    string str = "zoo";
    cout << exist(map, str) << endl;
    str = "zoro";
    cout << exist(map, str) << endl;
    str = "xtifx";
    cout << exist(map, str) << endl;
    str = "oto";
    cout << exist(map, str) << endl;
}
```

---

题目：给定m个字符 [a, b, c, d]，字符可能重复，以及一个长度为n的字符串tbcacbdata，问能否在这个字符串中找到一个长度为m的连续子串，使得这个子串刚好由上面m个字符组成，顺序无所谓，返回任意满足条件的一个子串的起始位置，未找到返回-1。

输入 [a, b, c, d] + tbcacbdata -> 3

输入 [a, b, c, c] + tbcacbdata -> 1

输入 [a, b, c, d] + abctbcdata -> 4

同力扣438

```c++
#include <iostream>
#include <vector>
using namespace std;
int func(string s, string p) {
    int res;
    int count[256] = {0};
    int l = 0;
    int r = 0;
    int len = 0;
    for (auto &e : p) ++count[e];
    while (r < s.size()) {
        if (--count[s[r++]] >= 0 && ++len == p.size()) {
            res = l; // 匹配命中
            return res;
        }
        if (r - l == p.size() && ++count[s[l++]] > 0) --len;
        //++l; // 每次左指针收缩一格，进入下一轮循环
    }
    return res;
}
int main() {
    string str = "tbcacbdata";
    string pattern = "abcd";
    cout << func(str, pattern) << endl;
    pattern = "abcc";
    cout << func(str, pattern) << endl;
    str = "abctbcdata";
    pattern = "abcd";
    cout << func(str, pattern) << endl;
}
```

## 字节提前批三面

7.30 70min

Raft的Leader挂了咋办

Paxos原理

科研方向，软件定义网络是什么

实习经历（大佬以前在微信呆过，问了很多钉钉的IM技术架构问题，还好看了很多组内文档）

IM读写扩散模型，钉钉咋做的（以前的模型是写扩散，现在在升级，会解决写扩散的一些问题，但出于保密性，我不能透露太多）

已读状态是怎么做的，有哪些点是比较难的（已读事件批量处理，正好是我实习的一个需求

异步队列用的是什么（MQ），你对MQ的原理熟悉吗（还没深入了解，实习时间不久，先把组内架构摸清楚，还没深入了解中间件

---

A与B轮流从 1000 个棋子里取棋子，规定每次最多取 7 个，最少取 1 个，谁最后取完剩下的棋子谁获胜，A先取，有没有必胜的策略？

刚开始算错了，1000除以8的余数是4。。。

其实是0，后来再思考了一会，给出了答案：如果B足够聪明，A必输

---

有一个很大很大的输入流，大到没有存储器可以将其存储下来，也不知道到底有多大，而且只输入一次，如何从这个输入流中随机取得 7 个记录。

蓄水池算法

---

```c++
class A {
public:
    A(int v) {
        _v = v;
    }
    void Run() {
        std::cout << "Hello" << std::endl;
    }
private:
    int _v;
}

int main() {
    A * p = NULL;
    p->Run();
}
```

扯了一下内存模型，应该是不会报错的

如果Run里面输出_v呢？（会报错

如果Run是虚函数呢？（会报错

面试完后本地跑了一下，是这样的

---

```c++
struct Obj {
    char a;
    uint32_t b;
    uint8_t c;
    uint64_t d[0];
};
sizeof(Obj) = ?
```

字节对其的知识点有点忘了，这题不是很会，猜了个1+4+8=13，面试官说ok，下一题，我问这是对的吗，他干脆利落地说：不对

（害，这问啥呢，打击自信心啊

最后反问面试官环节问了一下这题是怎么做的，面试官很耐心的给出了解释

如果没有第四个字段，应该是4+4+4=12，加上第四个字段是16，第四个字段不占空间，但会告诉编译器要按8字节对齐

这种用法在内核里经常用到，比如下面可以直接用下标访问

```c++
Obj o1;
uint64_t array[1024]; // 在内存中，array紧跟o1后面
o1.d[123]; // 可以访问array的元素
```

---

实现一个函数，删除所有 map 中 val 为 100 的元素

```c++
void RemoveElement(map<int, int> &elems, int target) {
    for (auto it = elems.begin(); it != elems.end(); ) {
        if (it->second == target) {
            it = elems.erase(it);
        } else {
            ++it;
        }
    }
}
```

---

给定一个字符串 s ，找出 至多 包含 k 个不同字符的最长子串 T ，输出子串 T 长度。

示例 1:
输入: s = "eceba", k = 2
输出: 3
解释: 则 T 为 "ece"，所以长度为 3。

示例 2:
输入: s = "aa", k = 1
输出: 2
解释: 则 T 为 "aa"，所以长度为 2

```c++
int func(string s, int k) {
    unordered_map<char, int> m;
    int maxLen = 0;
    int i = 0; // 快指针
    int j = 0; // 慢指针
    while (i < s.size()) {
        if (m.size() <= k) m[s[i]]++;
        while (m.size() > k) { // 当前区间不满足『至多包含k个不同字符』
            if (--m[s[j]] == 0) {
                m.erase(s[j]);
            }
            ++j; // 慢指针左移
        }
        maxLen = max(maxLen, i - j + 1);
        ++i; // 快指针左移
    }
    return maxLen;
}
```

## 虎牙直通车终面

8.5 50min 视频面

全程聊实习经历。。

挖的很深，比如IM产品的读写扩散模型为什么大都用写扩散，一直深究

还有分布式词典服务，状态一致也在深究，感觉面试官对分布式也很熟悉，还好之前看了ddia

## 深信服大牛计划一面

8.8 45min

昨晚组内聚餐喝酒，晚上有点着凉，早上起来晕乎乎的，还迟到了五分钟，状态不是很好，面试官给我的感觉有点慵懒，不知道是不是我迟到的原因

自我介绍完后，压根没问我的项目与实习经历，或者说压根没看我的简历，直接问基础

String类的拷贝构造函数，第一版代码写出来有个瑕疵，拷贝构造函数是没有返回值，我返回了*this，经过提示后修改了。然后在回答中提到了自赋值的问题，说拷贝构造函数要解决自赋值的问题，面试官反问确定需要吗，想了一下说不需要，然后面试官要我写一个赋值构造函数，要我判断一下自赋值的问题，我写成了`rhs == *this`，最后被纠错了，应该是`&rhs == this`。开头第一个问题，还没进入状态，有点懵，附上一个不错的资料：[C++面试中STRING类的一种正确写法](https://coolshell.cn/articles/10478.html)

排序算法有哪些（内扯了一堆），STL的sort怎么实现的，口述快排代码实现

哈希表呢（表空间，开链法，开放寻址法，Java的哈希表种链表长度超过8转红黑树，负载因子，rehash，质数，扯了一堆）

树的遍历方式有哪些，最开始达成前序中序后序，第一儿子下一兄弟什么的，扯了一会才说bfs和dfs，bfs和dfs如何用代码实现（队和列栈）

TCP三次握手协商了哪些东西，我说：协商了哪些东西？窗口大小？序列号？面试官说：你是不是对网络这些东西只是有个概念的了解，我说：不是，我有实践经验，用wireshark抓过包，用tcpdump抓过包blablabla。然后面试官就换问题了，计网再也没问过了。这里很不爽，感觉根本还没发挥就结束了，毕竟计网相对来说是我的强项

最后给我出了个问题，给定一个二维象棋盘，马的走法是日字型，可能会被棋盘的棋子別脚，随机给出一个起点和一个终点，求最短路径

我想了一会，没啥好方法，感觉不就是dfs回溯一把梭？

然后面试官说要遍历所有到终点的可能，时间复杂度太高了。

我再思考了一会，说用动态规划，弄一个二维数组dp，dp[i][j]是从起点到第i行第j列的最短跳数。

面试官想了一会，说『如果能建立这样的二维数组，那就没必要建立了，因为能够建立的前提就是你已经知道了答案』。

其实这里没太懂他说什么，不过我对马的走法有一定的疑虑，因为马可以迂回前进的，如果是卒子，肯定可以用dp的。于是继续考虑其他方法。

面试官这时提示：能不能转换一种数据结构？我想了一会说：应该可以用Trie（念作try）树吧，面试官好像没听过这个数据结构，反问：Trie树是什么。我说前缀树，每个节点保存当前点，当探索到终点，输出这条路的路径就是最短路径了。

显然，我的回答不是题库中的标准答案，他提示到：你提到了树，用什么遍历方式来解这道题呢？我心想，这不就是刚才的面试问题吗，回答bfs和dfs。

面试官问道：对于这道题，哪种更好呢？

我想了一会，对于面试官而言，他应该期望听到的答案是bfs，但是我对马的日字形走法还抱有疑虑，但也不想耽误太久时间，直接说bfs。

问为啥。

我说：可以想象一幅地图，用bfs可以从起点开始一圈一圈的往外遍历，当探索到终点时即可直接输出当前路径就是最短路径。我一边说一遍看面试官反应，这好像就是正确答案。

但是我没等他开口，说出了我的想法：我刚拿到这道题时第一反应是用dfs，感觉和我现在说的bfs是差不多的，因为给定了棋盘的起点和终点，你就知道了大致的方向，dfs是一条路走到黑，那我就给他定一个初始的方向。这就有点像启发式的A star算法，用来搜索最短路径是很合适的

面试官说：起点和终点之间可能会有其他棋子阻拦，你能保证你说的dfs是个好方法吗

我心想：bfs还得遍历其他方向，dfs碰到南墙还可以迂回一下，想象一个地图，我感觉dfs的方案会更快，但是我不太想和面试官争了，十二点了，感觉面试官要到点下班了，于是我说：这样看来，的确bfs会更好一点。

果不其然，面试官说今天的面试就到这里吧，我说好的，然后双方就互道拜拜了，没反问环节。

我面试官过这么多场，感觉这次面试的感觉很奇怪，有点不爽，特别是我在洋洋洒洒地讲排序算法与哈希表的时候，面试官好像在低头划手机。害，可能是正好有事吧，我又迟到了，减了很多印象分。但从面试问题来看，问的东西都很基础了，都是中规中矩的问题，没啥发挥空间，我的两段大厂实习经历也根本不问，不知道咋表现自己。有些知识点我是很清楚的，但是面试官没get到我的点，双方的风格不是很匹配，在某些问题上，面试官点到为止，『没有引导我去深挖』。

## 字节四面

交叉面 78min

面试官上来先介绍了一下，这是交叉面，介绍了一下自己所在的部门，还主动说了自己的名字（心里想着，是不是会稍微简单一点呢，后来啪啪打脸，不过也有可能是因为我菜吧

首先问了下阿里的实习内容，详细问了我的工作内容，也问到了IM的读写扩散等等，还问了一下我的工作难点是什么

再询问了腾讯的实习内容

系统调用read的流程（用户态切到内核态，磁盘驱动器，通过LBA找到块位置，读到内存缓冲区，再拷贝到用户进程里面）

有什么优化方法吗（DMA、还有零拷贝技术，比如mmap, sendfile，还有写时复制技术）

gdb调试，gdb怎么调试运行的进程？（gdb attach pid），gdb调试正在运行的进程，如果你还给它发RPC会怎么样（这里没太理解的他的意思，意思是多线程，就一个线程停在断点上）

北京小汽车摇号，20万人，每个人的初始权重都是一样的，但有人没被摇中，他的权重就会增加，用计算机的语言来解决这个问题（口述代码思路）

我想到每个人维护一个int值，初始为1，没有摇中就增加1，下次摇号时，把所有人的计数值在数轴上展开，比如第一个人权重为1，那他就占1，第二个权重未3，那他就占2，3，4，然后调用一次rand函数

面试官说明白我的意思，但不满意这个解法，提示说，能不能不存下来，但是每个人按宽度对应到坐标轴上去，想了很久，想不出来

int * arr N   大根堆
del k，  数组下标k

坦白：我只知道最大堆的一些特点，比如一个节点下标为i，他的左儿子节点下标是2i，他的右儿子节点下标是2i+1，他的父亲节点下标是i/2，然后增加和删除需要一些上滤和下滤操作，但是我没自己实现过

最后面试官说ok，再换一道，让我用C++实现一个线程池，我说可能有的api不太记得完整的，面试官说没关系，能写多少是多少

线程池

```c++
#include <iostream>
#include <pthread>
using namespace std;
class ThreadPool {
    static int kInitThreadSize = 3;
    ThreadPool() {
    }
    ~ThreadPool() {}
    void start() {
       is_start = true;
       for (int i = 0; i < kInitThreadSize; ++i) {
           m_threads.push_back(new thread(bind(&threadLoop, this)));
       }
    }
    void stop() {
       lock_guard(m_mutex); // 自动析构
       is_start = false;
       m._cond.notifyAll();
       for (auto it = m_threads.begin(); it != m_threads.end(); ++it) {
           it->join(); // 线程退出
       }
       m_threads.clear();
    }
    void threadLoop() {
        while (is_start) {
            Task task = takeTask(); // 取出某个任务
            if (task) {
                func(); // 线程里要干的事
            }
        }
    }
    void func() {
        while (is_start) {
            m_cond.wait(lock);
        }
        Task task;
        if (m_tasks.empty() && is_start) {
            m_tasks.pop();
        }
    }
    Task takeTast() {
        lock_guard(lock);
        while (is_start && !m_tasks.empty()) {
            m_cond.wait();
        }
        Task task;
        task = m_tasks.top();
        return task;
    }
    void addTask(Task task) {
        lock_guard(m_mutex);
        m_tasks.push(task);
        m_cond.notifyAll(); // 有任务进来，通知线程干活
    }
private:
    mutex m_mutex;
    Condition m_cond;
    bool is_start;
    vector<thread*> m_threads;
    queue<Task> m_tasks; // 先来先服务
};

class Task {

};
int main() {

}
```

大概写成这样，面了70分钟，然后面试官说由于时间关系就到这里吧，我大概明白你的（代码）的意思了，我没啥其他问题了，你有什么想问我的吗

解释了一下今天表现不是特别好，正好问到薄弱的地方，面试官说没关系，问了下对方的base与部门，是北京的推荐工程化落地的

## 拼多多一面

8.10 45min

给一个字符串str，将其转换为相应的long值，如果不是合法数字则返回null

问了下面试官，可能会非法，不会溢出

```c++
long long transType(String numStr) {
    if (numStr.empty()) return null;
    bool is_positive = true;
    int n = numStr.size();
    int i = 0;
    if (numStr[i] == '+') {
        is_positive = true;
        ++i;
    } else if (numStr[i] == '-') {
        is_positive = false;
        ++i;
    } else if (numStr[i] < '0' || numStr[i] > '9') {
        return null; // invalid
    }
    while (numStr[i] == '0') ++i; // remove prefix zero
    long long num = 0;
    while (i++ < n) {
        if (numStr[i] >= '0' && numStr[i] <= '9') {
            num = num*10 + (numStr[i] - '0');
        } else {
            return null;
        }
    }
    if (!is_positive) {
        num = -num;
    }
    return num;
}
```

topk（快速选择or最大堆，还说了为啥快速选择是On时间复杂度

海量数据topk（我答的是单机解法，最后把面试官搞得有点晕，最后直接把编程之美这本书搬出来了

两个很大的有序数组，求交集（先说了双指针，经过提示，如果交集稀疏可以用二分

有向图如何判定是否有环（我很心虚的说拓扑排序，但是展开讲的时候有点磕磕绊绊的

理想答案：方法是重复寻找一个入度为0的顶点，将该顶点从图中删除（即放进一个队列里存着，这个队列的顺序就是最后的拓扑排序），并将该结点及其所有的出边从图中删除（即该结点指向的结点的入度减1），最终若图中全为入度为1的点，则这些点至少组成一个回路。

腾讯实习（面试官是做存储的，竟然没问我深究我在腾讯的实习内容

阿里实习，展开挺多的

## 虎牙交叉面

8.14 30min 电话

感觉就是把我下周要实习答辩的内容说了一遍。。末了面试官说：你这两个月干了挺多事的啊

简单说了下腾讯的工作

腾讯和阿里的文化？更倾向于哪家？（这就HR面了嘛？）

反问：

1. 您是做啥的
2. 腾讯有意撮合虎牙和斗鱼，您怎么看（面试官说利好虎牙
3. 虎牙和斗鱼哪家体量更大（面试官说从二季度财报上可以看出，虎牙MAU是1.7亿，斗鱼少几千万，虎牙利润27亿，斗鱼利润25亿

## 深信服二面

8.15 45min

很愉快的一次面试，面试官非常耐心温柔有礼貌，跟一面面试官风格迥异

聊实习

malloc最大分配多少内存（我不太清楚具体最大值，但是我知道小于128K用brk在堆区，大于128K用mmap在内存映射区

C++内存分布（从虚拟地址空间高地址往低地址看，堆栈blabla

内存碎片怎么解决呢（答了伙伴算法和slab算法

io多路复用（select, poll, epoll

一千万个域名，怎么知道一个域名在不在里面（前缀树or布隆过滤器）

设计一个日志系统，包括采集、存储、查询（答了我在腾讯实习时接触的那一套ELK stack

100层楼，两个鸡蛋，用最少的次数测试哪层楼会摔碎（鹰蛋问题，我直接说了最优结论，在第14层测，在+13层测。。然后很简短地说了下这个最优结论的推导过程，其实推导过程记得不是特别清晰，好在面试官也没细问

我说个大概的思路，第一个鸡蛋为A，第二个鸡蛋为B：

1. 假设A先尝试第x层：
  1.1 如果碎了，B必须尝试1、2、3...x-1，所以总共需要x次
  1.2 如果没碎，那A还可以继续使用，出于利益最大化的考虑，A的后续尝试肯定是『跳』着去尝试，假设每次尝试都是+x
2. 基于以上考虑，我先随便假设一下，假设x=10
  2.1 如果A在x=10碎了，那么最坏情况下，B得从1尝试到9，所以总共需要10次（A的1次+B的9次）
  2.2 如果A在x=10没碎，按照每次+x的设想，
      2.2.1 A的第二次尝试是20，如果这时A碎了，B得从11尝试到19，所以总共需要11次；
      2.2.2 A的第二次没碎，第三次尝试30碎了，B得从21尝试到29，所以总共需要12次；
      2.2.3 以此类推，一直到A尝试90，如果碎了，总共需要18次（A的9次+B的9次）；如果没碎
3. 可以看到，每次+x是不太好的，越到后面，所需次数越大，究其原因，**A的每一次尝试都算作尝试次数，而B的搜索空间永远都是`[kx+1,(k+1)x]`，所以最坏情况下，尝试次数是递增的**，所以现在我们的目标是设计一种方案，使得无论危险层在哪层，我们的方案都是稳定的，且在最坏情况下是最优的
  3.1 如果A没碎，A可以继续尝试，但A尝试的『这一次』算作一次了，所以后续尝试的层数不应该是+x，而应该是+x-1
  3.2 假设A第一次尝试为x，那第二次尝试就应该『跳』x-1（这x-1的区间是用来给B搜索的），第三次就应该『跳』x-2（这x-2的区间是用来给B搜索的）。。。
  3.3 那x的选择就可以通过等差数列来求，1加到13的和比100小，1加到14的和比100大，所以x必须得从14开始选择
4. 综上，A的尝试轨迹应该是14、27、39、50、60、69、77、84、90、95、99（这里共11次），举几个例子验证一下最坏情况
  4.1 危险层是14层，总共需要1+13
  4.2 危险层是50层，总共需要4+10
  4.3 危险层是99层，总共需要11+3
5. 结论很简洁，关键是要把这个过程讲清楚

手撕代码：假设你是个咖啡店老板，你有一个一天的流水单，流水单每行是交易发生的时间及其金额，求两小时内最大金额发生在哪个时间段，输出起始时间即可

（为了简化，时间就用int型吧，可以用纪元时间戳表示

讲了下思路，维护两小时的滑动窗口blabla，这个时间复杂度是On，我觉得是个不错的方法，然后就让我写代码了

```c++
#include <iostream>
using namespace std;
bool isWithinTwoHours(int l, int r) {
    // 两个时间戳如果在两小时内则返回true
    return (r - l) < 2;
}
int func(vector<pair<int, int>> vec) {
    int n = vec.size();
    int l = 0, r = 0;
    int sum = 0; // 记录两小时窗口内的销售额
    int res = 0; // 记录两小时窗口内的最大销售额的左端点（起始时间）
    while (r < n) {
        vec[r]
    }
    return res;
}
```

还没写几分钟，面试官就说到时间了，你的想法很不错blabla（表扬了一通），明确告诉我过了

## 快手一面

8.19 1h + 8.20 1h

两个实习、两个项目

C++virtual关键字有哪些用法（小哥的发音把我整蒙了，最后是打字才明白是virtual

继承时的访问权限控制符有啥区别

汉诺塔问题（做法有点问题，其实可以更简单，但我的电脑没电了，面试官约了下次再面

补面40min

二叉树的前序遍历和后序遍历非递归实现（debug了一会，构造了输入，能work）

调用write是怎么的流程、用户态到内核态是靠什么机制实现的、电梯算法工作在哪一层（？？？

ceph是怎么工作的

害，说实话，我对存储了解不深的，腾讯实习两个月，只摸到了点皮毛，你跟我扯IM还好，存储真是一窍不通了

最后给我的建议是：多刷点代码，觉得我笔头有点生；可以深入了解一下分布式存储的论文，已经一些开源实现

反问：

1. 快手的存储是什么样的发展状态
2. 私有云or公有云

最后竟然给我过了，准备一下存储方面的知识，准备二面吧。。

## 拼多多二面

8.22 1h

聊实习（对于在线推送和离线推送的判断比较感兴趣，但我不是特别了解客户端的，说了一些自己判断

消息队列kafka，问了一些浅层的，如何持久化，消费了会不会删除消息，如何维护进度，深层我就不熟悉了，坦白在阿里实习时才接触，我写cpp的了解不深

问我熟悉哪种语言，我说c++，但面试官应该是写java的

c++多态怎么了解、虚函数是什么

友元函数是什么

为什么构造函数不能是虚函数，为什么析构函数得是虚函数

深拷贝与浅拷贝的区别

HTTP与HTTPS的区别，TLS的握手过程

epoll的LT与ET的区别

TCP可靠性如何保证（seq、ack、滑动窗口、拥塞控制

手撕：判断一个数是否是完全平方数

最快的是用一个公式：1+3+5+7+ ... + (2n-1) = n^2

```c++
class Solution
{
public:
    bool isPerfectSquare(int num) {
        int num1 = 1;
        while(num > 0) {
            num -= num1;
            num1 += 2;
        }
        return num == 0;
    }
};
```

也可以用二分法或牛顿法不断减小平方根的范围，最后判断离平方根最近的整数，其平方是否等于num来判断num是否是完全平方数

手撕：two sum

原来pdd的面试间是可以运行代码的，但是只能由面试官运行，这意味着报错原因是看不到的。。所以在写two sum时有很多小错误，比如忘记加某个头文件，漏掉某个分号，函数原型写错了，每次面试官都说你再仔细检查一下，这真的是考验肉眼观察能力了

## 字节五面

阿里转正了吗，怎么看字节和阿里

前面四轮技术面都问了很多了，就问你一个简历上的东西吧

quic为什么可以队头不阻塞（各流独立blabla，答的不算特别完整

概率题：一种流行病患病概率是1%，有一种检测试纸，检测的准确率是99%，我现在试纸检测阳性了，请问我患病的概率有多大？（数学题，条件概率

逻辑题：

1. 给你一个天平，32个重量不一样的石头，要比较多少次才能找到最重的石头（31次
2. 基于问题1，你已经找到最重的石头了，如何找到第二重的石头，还需要比较吗，还需要比较多少次？（类似于欧冠32强，画一个冠军的晋级路线图，实力最强的肯定是冠军，但亚军不一定是实力第二强的，总之：冠军这一路上碰到的队伍都有可能是实力第二强的队伍，所以五支队伍中选出最强的，需要4次）
3. 给你一个最多可称8块石头的设备，可以知道总重量，32块重量不一样的石头，如何找到最重的三块石头（没时间思考了，随便说了下就结束面试了

## 深信服三面

8.24

约了好久，总算约上了，好像是级别比较高，总算约上了，面试官挺强的，云计算都懂

个人介绍

问了很久IM的东西，主要围绕分布式来问，比如节点挂了怎么办，比如如何保证消息有序

科研项目，网络规模

学校参加社团了吗，有组织什么活动吗

反问

## 拼多多hr

8.28 35min

自我介绍

还有其他offer吗

对各互联网大厂的评价

你更喜欢哪种企业氛围

为什么投递这个岗位

接受调剂

工作的地域偏好

怎么选择毕业后的第一份工作

你希望拿到什么样的薪资

了解拼多多的情况吗，你怎么看待11116，能接受11116吗

老家哪的，父亲母亲工作，国企还是私企，独生子吗

有女朋友吗

说说你受到的挫折

为啥入党

实习时有跟产品对接吗

如果项目需要delay你会怎么做

实习期间碰到的有挑战的事，你觉得有成就感的事

如果给offer，可以提前实习吗，最快啥时候正式入职

