# 暑期实习面试记录

## CVTE一面（已挂）

通过1.5笔试，挂在1.13现场一面

自我介绍一下吧

挑个印象最深刻的项目讲讲，比赛一个人吗？你负责什么？openflow协议是什么？

c++多态怎么实现（编译时多态用重载，运行时多态用虚函数），虚函数怎么实现，答到虚函数指针位于类实例的头部时，面试官打断问如果有继承的话虚函数指针放哪？我吞吞吐吐说可能忘记了，但我知道内存对象模型，然后扯了堆、栈、只读数据区、代码段等等

堆栈的区别，栈保存局部变量、函数返回地址与参数，系统自动释放，堆保存new出来的，如果不delete会内存泄露，然后扯了一下自己看过一篇文章说c++的自由存储区实际上是用堆实现的，只是语言背景不同而已。再问增长方向，回答栈向下，堆向上，在纸上画了个图。忘记答堆栈的在系统资源层面上的区别了。

有用过智能指针吗？autoptr与weakptr讲讲，我说weakptr主要是为了解决sharedptr的循环引用使引用计数失效，追问手写代码举例autoptr循环引用（没写出来）

uniqueptr是什么，回答独占对象，举个例子独占对象（没写出来）

匿名函数有哪些捕获，我说值捕获引用捕获指针捕获，面试官问有指针捕获？我赶紧改口外部捕获，面试官说没有外部捕获，那我说我的答案就是值捕获与引用捕获，没深问了

TCP udp区别，面向连接有区别，可靠性有区别，拥塞控制有区别，连接对象有区别，说到udp可以一对多，面试官有疑问，我说组播，随手画了个图，可能比较自信就没深问了，首部固定字节有区别，说到udp首部固定8字节时，面试官打断问有哪几个字段，我说源和目的端口还有检验和还有最后一个是协议号还是什么的，面试官说只有三个，答的中规中矩（其实应该是4个，源和目的端口、校验和、数据长度）

tcp拥塞控制，回答reno vegas两个版本，前期只有慢启动，拥塞避免，后来加入快恢复与快重传，每个阶段用画图表示，问我坐标轴是什么，我说横坐标传输轮次，纵坐标拥塞窗口，这题答的不错

为什么有time wait阶段，答了计网书上两个原因，应该答的还可以

有动手写过网络编程吗，回答没有自己亲自实现过就没问了（减分项）

有听过粘包吗，我说没有，他说在网络编程中经常有的现象（减分项）

手写算法，判断字符串是否对称，我说从中间分开，双指针比较往两边移动一一比较，写到一半时说要注意边界情况，给他说了一下需要考虑奇偶情况

进程与线程的区别，答了资源分配的最小单位与cpu调度的最小单位，进城的定义， 进程间通信更复杂，地址空间独立与不独立，一个线程挂掉会影响其他线程 ，线程系统开销小，感觉没答完，想了一会说暂时只记得这几个

总结：面试官挺帅的，很温柔，面试官前面摆着台电脑，用来看题库和写面试者的表现，面试者是看不到的，桌上有白纸和笔，随时准备手写代码，回头来看，当时准备的真的很差劲。。。

## 淘宝商家技术部一面

2.24 17:00-17:30，因为收我简历的面试官是搞Java的，对我又很感兴趣，就让我面Java的岗位了

简历、项目

引用和指针，追问了哪个是对象

面向对象怎么理解（继承、封装、多态）

多态与虚函数

动态内存分配（new delete）

笔试：实现一个函数，传入两个字符串数组，返回共同字符串，要求用C++、Java、Python三种语言都实现一遍，最后跟面试官确定了是去重的（用set很快就实现了，难点在于三个语言实现，所以我为啥要说我学过三门语言呢？）

总结：预面，不难，纯聊天

## 钉钉一面

3.25 16:30-18:00，代码写得比较久

自我介绍、简历、项目

介绍一下智能指针（auto_ptr已废弃，unique_ptr独占式/禁止拷贝，shared_ptr引用计数/自动析构/死循环，weak_ptr弱引用解决shared_ptr死循环的问题）

介绍一下STL，基本上按照STL源码剖析来的，空间配置器两级、空闲链表、内存碎片，迭代器粘合剂、隐藏内部实现、萃取，容器vector、list、heap、set、map，仿函数、适配器inserter与基于deque的stack和queue

介绍一下操作系统，我主要说了一下内存管理（交换技术、虚拟内存：页表页面页框，页面置换算法LRU）与死锁（提到了华为比赛，四个产生原因）的理解

CPU调度方式有了解过吗（Round Robin，优先级调度，优先级调度可能会产生饥饿的问题，解决方法是偶尔提升一下优先级，还有一些基于优先级的变种调度方法）

进程间通信（管道、信号、信号量、共享内存、消息队列、套接字，还多说了一下最好的是套接字，因为可以跨主机，在管道那里还提到pipe函数中，fork后父子进程一个关fd[0]一个关fd[1]，以及单工的问题）

网络编程，介绍一下epoll（先说了I/O复用的好处，内核注册事件表、LT与ET）

为什么要有time wait（两个原因），time wait过多怎么办（重用与快速回收）

数据库MySQL的索引是什么，简单介绍一下（B+树，减少磁盘IO，数据存在叶子节点，叶子节点有顺序的指针，可供范围循环）

MySQL的主键索引和副键索引（我回答只知道主键是唯一的，没具体了解过）

你了解哪些开源产品（我说了阿里的Dubbo，分布式的RPC框架，说了一下RPC的概念）

服务器怎么负载均衡（我说服务器集群，类似线程池那样，一个负责接收连接，具体业务交给其他服务器）

HTTP1和2的区别（没怎么答上来，但我还是说了一下我的推测，更安全的SSL、缓存更好、状态码更多、交互更加丰富）

网页编辑器白板手撕代码：合并k个有序链表

拿到题后我说了我的想法，可以转化为两个有序链表的合并，这样合并k-1次两个链表即可，但面试官表示效率不理想

然后我就想到了刚才的做法会重复比较，于是说了个更快的想法：依次比较k个链表头部，把其中的最小值加到输出链表后面，这个得到最小值的链表的cur指针后移一位

写完后在面试官提示下想起了用最小堆改善最小值的操作

总结：总体而言很轻松，很多题目都是开放的，我可以尽情吹我知道的所有知识：）

## 淘宝商家技术部二面（已挂）

2.26 10:00~12:40，全程瑟瑟发抖

项目30分钟，问的很细，调度器和计算结果那里没搞懂，一直在问

类和对象（封装、继承、多态）

为什么有类型（扯汇编，扯安全），C++和Java是强类型语言（不知道。。。）

三种语言关于继承的知识，C++因为虚函数有菱形继承的问题所以引入虚基础，Java不支持多重继承，但有implement多个接口可以间接实现，Python最基本的单继承、多继承、多级继承、混合继承都支持，没有特别

友元举个例子，我举的例子是钱的账户account与存取的交易transaction，account内部不应该定义add和sub方法，而应该交给transaction去操作，更加安全，而且也符合类的松耦合，类的规模尽可能小

手撕代码（可以在本地IDE写，共享屏幕）

设计一个访问控制IP的类，一分钟内超过30次访问，该IP在接下来的3分钟每分钟只能访问三次（限时一个小时，可以上网查一些接口用法，基本功能都没写出来，我太渣了-_-）

实现LRUCache（限时半个小时，写完后设计一下测试用例，有点小bug，最早的项目没有移除）

总结：大佬不愧是大佬，瑟瑟发抖，在项目那里刨根问底，类与对象那里讨论了很久，第一个代码题有点难

## 腾讯TEG一面（直系师姐内推）

3.2 11：20-12：20，电话面试

自我介绍

华为比赛，死锁，优化手段

科研，背景，怎么实现的，定价策略，控制器集群（对方是做分布式存储的），

深拷贝与浅拷贝

析构函数为什么是虚的

三次握手交换了什么（seq/ack+发送窗口），发送窗口是干什么的，解释滑动窗口协议

信号和信号量的区别

IO协议栈是什么（不懂，能不能给点解释），面试官举例说打开一个文件，从键盘输入再保存，这段时间发生了什么。我回答说键盘是外设，产生IO中断，CPU读取放入内存，再从内存放入磁盘。面试官追问读取数据怎么从内存写入磁盘，我扯了一些页面置换什么的（答非所问），中间我还扯到了L1 L2 L3缓存，被追问里面有什么，我不是特别了解，只说了有一些寄存器什么的。

32位系统，地址空间是多大（2^32=4GB）

物理地址空间和虚拟地址空间怎么转换（扯了一些基本定义，最后坦言具体怎么转换的不知道，答案应该是MMU）

内存有哪些技术（开放回答，交换技术与虚拟内存，重点讲虚拟内存、页面页框页表、缓存淘汰的策略一般是LRU）

算法题：以单词为最小单位翻转字符串，先整体翻转，然后遍历，碰到空格时把前面一小段翻转（单词翻转）

算法题：10万个数字找重复数据，我回答了哈希表、位图、布隆过滤器、排序

还有什么想问，为了表现一下自己，问了一下对方产品怎么做的一致性，还问了有没有借鉴PAXOS与RAFT算法，对方给我讲了挺多关于存储的知识

总结：没问网络并发与数据库，除了操作系统的几个问题，其他都答的挺好的，看来要多看看操作系统的细节了，最后的提问交流还挺愉快的

师姐反馈，过了一面，等3.5开系统就二面。

## 阿里零售通一面（未选择）

3.5电话一面，54min，投的后台，因为没有后台没有C++，所以推给了做搜索引擎的算法组，所以对算法扣的很细

抓项目，介绍SDN，问SDN大赛，问流量调度算法，这几年做了什么成果

再抓项目，dijkstra怎么改良，为什么要用dijkstra，floyd为什么不好，时间复杂度怎么计算，松弛操作是啥

再再抓项目，LDA算法是啥（稍微介绍了下，具体原理没了解），狄利克雷分布是啥（不知）

指针和数组的区别（谈到了浅拷贝）

浅拷贝和深拷贝的区别

介绍一下排序算法（冒泡、插入、快排，扯了下STL的内省排序、堆排序、归并，还说了下三种O(n)时间复杂度的计数排序、桶排序、基数排序）

有什么想问的，我问了他们搜索具体是做什么，团队规模多大（说只有两位同学。。。这有HC吗？

## 阿里国际化一面

3.6 1h，Java岗位

自我介绍

内存泄漏，new,delete,malloc,free,构造函数,析构函数，智能指针，循环引用，深拷贝浅拷贝

Linux开机的过程（bios，硬件自检，启动MBR，init，在inittab配置文件中确定运行权限，开启用户进程

Linux装载的概念（我说一切皆文件，为了让操作系统知道如何操作文件，就需要装载，但查了下，面试官应该问的是挂载（mount）的概念吧

软连接和硬链接（我说这好像是文件系统里的概念，我不太了解）

Linux命令cat，如何实现tac，反过来输出文件，我说fseek从后往前扫描文件里的每一行，用一个while循环，到头就结束

如果文件很大，无法一次性装入内存，怎么办，我说会产生缺页中断，说了下虚拟内存的机制

synflood是啥，怎么产生危害的，如何避免，我说服务器不重传那么多次第二次握手，早点结束，后来又扯到了SDN大赛做的源地址验证

引入SDN大赛，介绍SDN概念，起源，优势

说说hashmap，STL，哈希冲突，开链法和开放地址寻址法，开链法怎么优化时间复杂度（我首先说vector，插入时排序，然后二分查找，后来面试官说vector的插入不太好，我想到了红黑树，但还是在面试官提示下才想到要把哈希表和红黑树结合，我当时想的是何必在unordered_map里面再用map，直接用map就好了，但是面试官的要求是想在哈希表最差情况下是O(logn)的查找时间，所以要两者结合）

红黑树的性质，为什么比树要好，在哪里有应用（我回答了epoll里面）

15min反转单链表，一次性AC了，还不错

## 腾讯TEG二面

3.6 牛客网1h

SDN项目，讲到令牌桶，问我怎么实现，我说队列，差点讲生产者消费者模型（我怕我讲了之后要我现场实现一个）

华为比赛，碰到什么技术难点，怎么实现的

epoll的工作模式，优缺点

select怎么做的，缺点，内存开销

重载怎么实现的，名字翻译

虚函数

管道分为哪几种，匿名管道怎么实现的（fork，拷贝父进程地址空间，共享同一个管道socket，所以可以匿名通信

手撕代码：二叉树的（最大）宽度。牛客网面试房间，写完之后要调用main函数输出的。

当天师姐反馈，过了二面，三面是大boss，很严肃，可能会很有压力，做好心理准备（事实证明，做了心理准备也没用。。）

## 阿里国际化二面（未选择）

3.7 50min，两道代码题：输出链表倒数第k个节点+青蛙跳房子

面试官面的是Java岗，我坦白投的是C++，所以运气很好地给我换成了两个算法题，而且都不难，做的不错

## 腾讯TEG三面

3.10 腾讯会议1h

怼项目，优化手段都没问、调度器也没问，就问为什么会有死锁，我回答说调度规则决定的，能否试探加锁去解决死锁，我说不行，因为车辆不准只走一部分，如果它没法走满速度，那它会等待，这样有可能会循环等待，举了个四方形环路的例子，这个例子给出来后才打消了面试官的疑虑，庆幸当时能够在巨大的压力下构建出一个死锁场景。

问SDN项目遇到的困难，我说用户与控制器通信的方式弄了很久才知道，面试官认为这是一个很基础的功能，任何SDN控制器都要提供，说我技术选型有问题，我回答最开始没想到需要这个功能，这个框架已经搭建好了，所以就没想其他SDN控制器，这需要自己手动实现，最后是通过NAT技术转换实现的用户与控制器通信的（这块有点减分，说我技术选型有问题，语气略生硬）。SDN项目里的时延检测模块，为何精度要好（SDN环境下，交换机没有能力处理包头，所以要上交给控制器，所以得自己实现检测方法），时间是怎么得到的（我回答说Python的time库，调用time.time()即可得到当前时间），追问time函数返回值的精度是多少（我被怼的有点慌了，这里也忘记具体精度了，被狠狠地怼了一番）

Linux的定时精度，怎么往前走的（晶振，产生一个滴答，定时器，如时间轮，这里应该算是回答上来了）

进程间通信，要发送10GB数据，要怎么做，首先说了管道，再socket，然后用socket距离说了流程：因为socket有缓冲区，所以可以先分段，然后再一边写，一边读。然后后问我IPC哪个方式最快，回答共享内存，话题转移到共享内存的实现了，我说mmap，问我有没有实际写过，我说没有，但我知道一些应用场景。

mmap有哪些应用（malloc分配内存，以及epoll往内核注册事件，这里回答上来了）

集合，里面每个数字都有两个，只有一个数字只有一个（我回答异或，问我有没有其他的，我说哈希表，然后详细说了两种方法的具体实现以及时空复杂度）

智力题，药丸（回答出来了）

总结：面试官给我的压力很大，说话语速很快，整个面试处于一种很紧张的状态，被怼项目的时候差点想放弃，但还是坚持面完了，可以说，这次面试极大地提高了我的承压能力。

面完问师姐，暂时还没消息，我以为凉凉了，当天晚上告诉我过了，激动万分。

但是面试状态一直是复试，中间拜托师姐催催，但是还是没反应，直到3.19，观望状态突然变为了初试，我慌了，赶紧问师姐，师姐问了HR，说两种可能：要么凉、要么换组了。当时万念俱灰，非常沮丧。

3.20状态又变为了复试，我懵了，晚上状态直接变为了HR面试，开心极了。

## 钉钉二面

3.11 1h

介绍项目的时候没怎么提我的SDN比赛与科研项目，重点说了华为软件精英挑战赛

死锁怎么解决的，为什么产生死锁就得回溯or重来（因为调度规则的原因，车速必须打满，否则得等待）

看我比赛用Python写的，问我为什么Python比C++慢，我回答说一个是静态编译语言，一个是解释型脚本语言，C++对内存控制更加贴近底层blabla，Python和C++各有什么优势（Python脚本，快速搭建原型，追求性能再用C++重写）

const常量与宏定义常量的区别

C++多线程了解吗，要注意什么，有什么锁，问到读写锁，我说C++里面好像没有读写锁，他说是操作系统里的读写锁

内存泄漏怎么办

shared_ptr重载了=运算符，里面有什么，要注意什么，返回值是什么

服务器端有100万个TCP长连接，可能会出现的问题，首先回答说一个连接占用一个socket，socket有最大数量限制，没法支持100万个，然后说一个TCP连接还有发送缓冲区和接收缓冲区，追问大小是多少，我说记不太清了，4196kb，通过套接字选项或内核文件可修改，然后继续回答100万个TCP连接可能会把内存占满。后面还答了CPU不够，可能计算不过来，导致客户端发送请求后久久得不到响应

DDoS是什么

SYN FLOOD怎么处理，我说清洗非法源地址加上服务器端减少重传第二次握手包的次数or快速放弃连接，再问有什么方法可以减少SYN包带来的资源消耗，我说TCP fast open，然后解释了一通，但好像不是他想要的，他愣了一下就跳过了这里

TCP半连接是什么意思（发生在四次挥手的时候，客户端关闭说明没有东西要发送了，服务器端仍然可以发送），三次握手的时候有半连接吗（没有，因为只有双方established才能通信）

slow start是什么，为啥要slow start（不知道网络是怎么样的，所以要用小包探测，如果直接发大包，那会给加剧拥塞）

看过什么书

有看过什么开源产品/项目的代码吗，如redis、memcached、libevent、levelDB，我说大公司开源产品的源码没深究过，最熟悉的源码可能是STL吧，按照书本内容按图索骥

设计模式知道什么，单例模式怎么实现（双检锁版本or局部静态对象版本），双检锁为何会失效有深究吗（我说在stackoverflow上看到的，但原因是由于操作系统平台引起的，没深究）

现在其他公司or部门面试情况怎么样了

你觉得你自己最大的缺点是什么

遇到最难的技术问题是什么，怎么解决的

如果重来华为比赛，你觉得有什么可以改进的（用C++重写，用冠军队伍的二分发车法）

问我有什么问题，我问了下IM的写扩散在大群的里的问题，这是个我提前准备好的针对问题，C++在钉钉中主要做IM，所以提前了解了IM的一些知识

总结：总体问的不难，很多问题我正好有复习到，所以发挥还不错

## 阿里支付宝网络技术部一面（未选择）

3.11 50min

不愧是搞网络的，对于我的SDN项目很感兴趣，先问我当时SDN比赛的题目，我先给自己了一个台阶，“现在来看，当时的想法不是特别的完善，但是也很幸运的获得了全国一等奖”，然后说明了流量调度算法的场景，部署在域内的接入交换机上，然后说到当时我在武汉华科的决赛现场做方案展示，事先排练过很多遍，展示的时候很不错，评委给了高分，所以获得了全国一等奖

华为的软件精英挑战赛也几乎是我全程在介绍，优化手段，死锁产生原因和死锁，复现调度器，有问到赛制流程、参赛人数这方面的问题

两个项目都问了我在团队里面的定位，负责的内容，收获是什么，技术难点是什么

TCP拥塞控制算法了解多少，非常开放的题目，我从拥塞控制的老版本Vegas、Reno、Tahoe，一直到cubic，再到最近几年谷歌开源的bbr

quic了解多少，非常开放，我说了减少握手时间、避免队头阻塞、在应用层实现这些方面，面试官觉得我说的挺好的

问了我一个模糊不清的场景题：quic和TCP怎么保证传输，用哪个，我说先用ping命令之类的手段去探测网络情况，再根据quic和TCP的特点去选择，TCP是面向连接的，更加可靠，而quic更快

我有什么想问的，quic、bbr在业界使用情况怎么样，5G会不会带来新的发展，面试官从他的角度上给出了自己见解

问我还有其他面试没有，我如实说了

还问我籍贯，正好是湖南老乡，最后说有机会一起共事

## 美团到店事业群一面

3.12第一批笔试，后两题直接输出样例骗了点分，五题加起来算a了两道吧

3.16 15:00-15:40，后端开发，主要写Java，还有一些RPC、中间件、MQ什么的

项目，对惩罚项和死锁比较感兴趣，没有刨根问底，应该是觉得项目做得还可以

CPU调度方法，讨论了一下饥饿现象的产生和如何解决

哲学家就餐问题，怎么解决死锁

对数据库有多少了解，索引的注意事项，b+树和b树的区别

看我比较熟悉计算机网络，从网址输入url到看到页面的过程

总结：感觉很简单的一次面试

## 微软一面

3.18苏州软件开发，11:00-12:00

自我介绍顺带介绍了项目

讲讲ARMA

看我网络还行，问TCP三次握手的过程，为啥两次不行

ARP是啥

手撕代码：输入二维数组vec，行数是交通灯的位数，列数是表示一个数字的晶体管个数（固定为7），vec[i][j]为1表示第i位的第j个晶体管亮了，为0则不亮，但是现在有可能有些晶体管坏了，导致数字残缺，现在给定这样的一个二维数组，求出所有数字的可能（保证输入肯定有解，每个数字至少有一个晶体管是亮的）

首先跟他说了我的想法，先拆分成每一位数字可以转化成的合法数字，然后n位，前后组合即可，每一位数字可以转化成的合法数字可以用回溯算法来做，因为晶体管只有7个，只需要对没点亮的晶体管增加一个分支进行探索即可，最多2^6

最后时间到了，还有格式化输出函数没写，面试官问我回溯算法时间复杂度是多少，因为至少有一个晶体管是亮的，只需要对其他6位进行回溯，所以是2^6，总共n位，所以是O(n*2^6)=O(64n)，当n很大时，可以认为是O(n)

面试完后来想到一个优化手段，把数字与它点亮的晶体管序号做映射，比如1：{5,6}，即数字1只需要点亮第5根与第6根（从0编号），然后读取残缺的数字，假设读到{0,0,0,0,0,0,1}，即只有第6根点亮{6}，可以发现{5,6}包含{6}，所以残缺的数字肯定可以转化为1，再试探能否转化2、3...，10个数字遍历完后，当前残缺的数字能转化成的合法数字就全部找到了，存起来，最后格式化输出

## 美团到店事业群二面（已拿offer）

3.21 16:20-18:20，本来约定是16:15-17:15的，但是面试官上个面试还没结束，所以先扔给我一道题

牛客网手撕代码：大数相加，造了几个测试用例，都通过了，解释了一下代码思路

如何优化你的代码（去掉补零操作），如何改造成浮点数相加（让小数点对齐，整数部分位数少的前面补零，小数部分位数少的后面补零）

17:00 面试官开视频了，进入面试环节

自我介绍

介绍华为比赛的时候扯了围棋的蒙特卡洛搜索以及启发式最短路径算法A*，面试官瞬间懂了我是在做啥

四个项目都简单问了问，坦白电商网站项目是个人学习用的，爬取公众号推文的文本分析项目也讲了讲

问我三大语言的了解程度，还打开了我的简书（其实写的东西都很基础）

数据库怎么优化

场景设计题（30min）：需要存储几个文件，如何用代码实现事务，提交时要注意什么，需要满足事物的四大特性，考虑隔离的级别，考虑锁与并发，问得特别细，而且非常开动脑筋，感觉是没有完美答案的，只是用来考察候选人对知识深度的理解

NoSQL了解多少，我回答知道一些redis和memcached，然后说最近看了篇文章redis的有序集合是用跳表实现

看过什么源码，muduo和c++的STL

你喜欢与他人一起工作，还是独自工作

你如何承受压力，如果工作很忙，你会学习吗

和他人意见不合怎么办

你的优点缺点

喜欢北京吗？上海呢？毕业想去哪个城市？

反问环节，我知道了：

1. 美团事业群是按业务分部门的，比如到店事业群中分为酒店业务线、旅游业务线、餐饮业务线，都是解决实际业务问题的。
2. 统一招聘，发offer的时候再确定部门和岗位，也就是说，现在面我的面试官，以后不一定同部门

总结：感觉二面面试官也是挺友善的一个人，场景设计题的确很烧脑，两次面试都没有问语言，因为知道我是写C++的，操作系统也问的不是很深，计算机网络与网络编程也不是很深，面试的难点恰好就是我最不熟悉的领域——数据库，虽然我也用过MySQL，但是不像Java后台开发那样了解得那么深，况且我也没什么分布式经验，感觉有点面起来有点吃亏。但是还是给我过了。

## 微软二面（已挂）

英文自我介绍 大概3-5min

白板手撕代码：给一个二叉树，输出每层最右边的节点，剑指offer的“按行打印二叉树”的变形，最后用一个测试用例完整地口述了一遍代码流程，顺便问了时空复杂度

反问

总结：几天之后收到了thank you letter，我觉得可能是第一面的代码不是面试官想要的，第二面的代码虽然完成了功能，但是速度又不够快，看了微软面试还是挺难得，需要有很强的算法刷题基础

## 钉钉三面

3.26 睡午觉时的突袭电话面试，23min

我是3.20第一批笔试的，两道题只拿到50分，但考虑到题目偏难，应该可以过，3.26上午看到官网状态从简历筛选中变为面试中，于是在钉钉上问了下hr，她说会安排的，没想到在下午午睡的时候就来电话了。。。

介绍最有收获的项目

饥饿，如何解决，多级反馈队列

悲观锁和乐观锁，扯了下乐观锁的实现（版本号和CAS），原子操作啥的，乐观锁的写时检查会不会有问题

一个进程对全局数据修改，另外一个进程看得到吗，扯了一些寄存器、内存地址、volatile啥的

进程与线程的区别

malloc和mmap的区别，映射区是什么（强调了一下是C语言的内存模型）

解释事务的ACID

MySQL的四种一致性（没答上来

一条MySQL语句执行过程（没答上来

总结：本来以为第三面是交叉面的，可能是为了完成总共五面的流程，插进来一次简短的面试，我可以感觉对方没有想多花时间面试的欲望，他说结束的时候，我愣住了，问就完了吗，对方说是的，前面已经有两轮了

## 钉钉四面（交叉面）

3.27 14:08-15:03

为什么这个时间要记这么清楚，是因为我在3.27中午接到了心心念念的腾讯HR面试邀约3.27 15:00，所以想着小憩一会再迎接HR面试的，在睡梦中突然来了个杭州电话，钉钉四面（交叉面）来了！一边接电话一边起床，慌慌张张的，首先明确跟面试官说三点之前要结束，他说没问题，于是整个面试他的语速都非常快，问题一个接一个，以下记录可能不太完整

项目

手写代码match，用C语言写，不能用容器

刚才这个手撕的函数，返回值是int*，在栈还是堆，为什么

vector在栈还是堆，能开10万个元素的vector吗，怎么扩容的，怎么开辟内存，vector作为函数返回是在哪，有什么要注意的（这里回答的不好，我最开始回答的是在堆上，但面试官问到vector作为函数返回在哪时，我又把答案改成了栈上，还说会有爆栈的风险。其实vector就是在堆上的，底层由allocator去维护，所以函数退出时，普通定义的vector也可以由allocator自动回收）

gdb调试，开启什么参数，切换线程，切换栈（只知道用bt打印栈），打印参数时被优化了是怎么回事（不知道）

看过啥开源项目（陈硕的muduo网络库）

写完代码后，有什么优化手段（我以为是在写代码时注意优化，他说不是的，我回答不会了）

全局变量可不可以在头文件中定义，为什么不行（应该是不行的，但是原因我不知道，我扯了一会extern，然后说不知道，正确答案见[能不能在头文件中定义全局变量？](https://blog.csdn.net/baidu_35679960/article/details/79200865)）

topk问题，基于partition的快速选择算法的时间复杂度为什么是O(n)而不是快排的O(nlogn)（不是分治而是减治，等比数列求和可以知道是O(2n)，省略系数就是O(n)了

数组中所有数都是成对的，只有一个数落单了，找出它（异或，只需O(n)时间复杂度）

Q：看来你有所准备啊（指的是两个算法题）

A：啊没有没有（一顿傻笑）

Q：你觉得你的优点是什么，你觉得这次面试你发挥得怎么样

A：巴拉巴拉，发挥得不是很好

Q：你认为你的代码能力在班级排第几

A：班级50来个人，我觉得能在前五名吧

Q：但我感觉你的手撕代码不像是前五名的水平

A：可能是因为有点紧张

Q：你确定你是因为紧张，还是因为能力没那么强？

A：紧张

Q：但我觉得你在vector那里不好

A：不好意思，可能这块知识我不是很了解

Q：你有什么要问我的吗

A：因为我的问题基本上在前三个面试官都问过了，所以没有其他问题了

Q：好的，那就这样，谢谢，拜拜

## 腾讯TEG HR面（已拿offer）

3.27 中午收到下午三点HR面试邀约的邮件，于是打算小憩一会，在睡梦中突然接到一个来自杭州的电话，阿里四面来了！好不容易面完，挂完电话的一分钟之后，广东电话就来了。

3.27 15:05 本来约好电话面试，但是由于通话不清晰，改为了在腾讯会议不开视频的通话面试，以下A是本人

看你的比赛经历比较丰富，你是怎么看比赛的呢

A：因为在校学生参与实际大型项目的机会比较少，比赛是个很好的选择，能锻炼编程能力，也能锻炼解决问题、分析问题的能力

那为什么不来实习，而去比赛呢

A：腾讯要求比较高，为了打好基础，提高自己，所以我选择了打比赛，而且当时也没系统地复习过后台开发相关的知识，所以还是继续学习，参加比赛，提高自己

说说华为比赛

A：巴拉巴拉

比赛的分工是怎么样的呢

A：我是队长兼主程，队友辅助巴拉巴拉

华为比赛过程怎么样的，有遇到什么技术之外的难题吗

A：巴拉巴拉（团队合作）

嗯。看得出来这个团队合作对你来说是难忘的记忆

在长达两三年的科研项目中获得的最大收获

A：思维模式，发现问题-分析问题-解决问题，巴拉巴拉

（好像很认同这个思维模式）你在什么时候发现自己掌握了这个思维模式呢

A：直接举了华为软件精英挑战赛的例子，从分析题目，到提出问题，用优化手段解决问题，再到碰到技术难题，再集中攻关，最后收获成果，这个成就感是很强的，巴拉巴拉

你没有互联网大厂实习经历，如何理解互联网后台岗位

A：虽然没有实习，但是有很多了解，通过前面几轮技术面，我相信我的后台知识储备也是过关的，我也非常想进腾讯互联网公司，互联网公司主要是做产品与服务，像腾讯这种大体量的公司，产品要服务于万千用户，那为了提供更加优质的产品与服务，就需要技术人员的分工合作，前端后台等等，后台的方向有很多，数据库、服务器，我相信腾讯肯定用的是最好的硬件资源，但再好的设备也要交到人的手上才能发挥优势，后台就是做这样的事，我们要做的就是最大化利用硬件资源，为产品与服务提供基础保障等等，巴拉巴拉

你讲的挺好的，很有主持人范，我都被你带进去了

A：我以前做过主持人，所以说话这方面还算不错

实习时间

A：三个月没问题的巴拉巴拉

你有什么问题呢

A：大概什么时候有结果

几个小时后去官网查询状态即可，如果是已完成，就等offer审批，审批需要两三天，大概下个星期会有结果

A：我会和我的内推师姐在同一个部门吗

（查了一下电脑，发现我的面试官也是同一个部门），可能会

A：我觉得如果有很熟的直系师姐带我的话，我会成长得更快

不用担心，我们会安排导师，都很nice，而且我相信你的沟通能力，肯定可以可以成长得很快的。最后有没有面其他公司

A：投了一些简历（但我最想进的还是腾讯，我忘记说这句话了！）

总结：14:08-15:03刚面完钉钉四面（交叉面），P9大佬还让我手撕代码，问了很多东西，因为知道我三点要结束，所以语速很快，我觉得我发挥得不算太好，在听腾讯HR说话的时候，还偶尔还有点走神，思绪还没有完全从半个小时前的一些问题中出来。所幸HR小姐姐很温柔，说话轻声细语，很快我也冷静了下来，开始发挥出我应该有的水平。从3.2一面，到3.6二面，再到亚历山大的3.10三面，以为自己在总监的连环炮下要凉了，但内推师姐说我过了，但是简历一直没更新，3.19，我的状态变为了初试，当时心灰意冷，师姐问了HR，说要么凉，要么转组，但3.20下午又变为了复试，感觉峰回路转，晚上又变为了HR面试，我心情激动，一直等啊等，终于在3.27中午接收到了面试邀约，许愿offer！

4.1 17点，在撸铁的时候来了个电话，广东深圳，座机号码，oc来啦，两个小时后收到了录用函，感谢tx爸爸收留。

## 美团HR面（已拿offer）

3.27 18:00-18:10

300RMB/天，一个月房补1500

## 钉钉HR面

3.28 13:30-14:30

项目

成绩

英语好吗，真的好吗

家庭情况怎么样

分享一下最初不擅长，但是迎难而上的事情

你到底想成为什么样的人，具体画像

你喜欢什么体育锻炼

目前为止，坚持得最久一件事情是什么

参加什么健身项目

健身的难点和阻碍是什么，坚持很难吗

最印象深刻的收到批评的事

作为组织者完成的团队任务，分享一下

比赛取得成绩最关键的因素是什么

所在行业的动态，以及竞争对手的动态（钉钉、企业、飞书啥的）

过去两年，遇到最棘手的问题

复盘项目，有什么改进空间

团队协作有分歧、最后达成一致，分享一下

同学对我的印象，有什么负面的吗

你通过什么途径来学习技术

有在开源社区发表过什么吗

有论文吗

现在最佩服的人是谁

总结：一个小时的密集开放性问题，很难顶。。

## 虎牙一面

3.31 电话 1h

派生类=子类，父类=基类

看过什么C++书

后台开发是什么，与项目关系强吗（最后面试官说现在互联网公司不缺钱，买了大量的硬件，不需要人力那么强，可能跟我想的后台开发不太一样）

extern是什么---extern在变量前、extern "C"在函数前

Q：extern "C"在什么场景下使用

A：不需要虚函数重载的情况

Q：这是为了用而用，有没有不得不用的场景

A：只支持C编译器的开发环境下？

Q：那根本没法编译cpp了嘛，其实答得差不多了，当C++要作为库文件给C去调用时，不得不用

重载与覆盖有什么区别---重载的定义、覆盖的定义

Q：如何调用非虚的重载过的父类函数

A：static_cast可以吗

Q：emmm 这是一种方法吧，怎么样避免覆盖呢？

A：C++11支持的final关键字

Q：emmm final是避免虚函数进行重写吧？你可能没理解我的意思，父类有个非虚函数，我想在子类实现一个同名函数，但又不想覆盖父类，我想实现一种重载的机制

A：那我把这个返回值修改一下可以吗

Q：恐怕没有关系吧。emmm没事，想不起来就算了，这是比较生僻的语法。

析构函数为什么要声明为虚函数---内存泄漏

Q：在什么场景下没法析构呢

A：定义指向父类的指针，但是指向派生类，如果析构函数不是虚的，那么delete这个指针时，派生类的独有资源无法析构

Q：什么情况下派生类没有多余/独有资源

A：派生类没有自己定义新的数据成员，又没有重写虚函数

Q：如果重写了父类的虚函数，就会有多余的资源吗

A：对，因为重写虚函数，虚函数表要更新，而且派生类对象有一个虚函数表指针

Q：如果子类没有自己定义新的数据成员，只是重写了一个虚函数，那么它的内存体积会比父类大吗

A：emmm 应该是一样的，数据成员是一样的，非虚函数不占用类对象的内存空间，而父类与子类都有一个虚函数表指针，也是一样的

Q：如果在父类的虚析构函数中调用了虚函数，子类重写了这个虚函数，那在析构时，父类的析构函数中执行的虚函数是父类的还是子类的？为什么？

A：父类的，一般来说，在析构函数不应该调用虚函数，因为没法体现多态性，在析构时，顺序是先析构子类再析构父类，所以当执行基类的析构函数时，子类已经析构完了，所以虚函数只能是父类实体的

Q：子类没有重写父类的函数，但子类有自己的一些内置类型，如果父类的析构函数不是虚函数，那会产生内存泄漏吗

A：应该不会，巴拉巴拉（乱扯，什么堆空间）

Q：（拉回主线）我要delete一个类，类中的成员变量都是在堆上的，你再想想

A：（沉默了10s）我总觉得不会产生内存泄漏，可能是因为有什么内存回收的机制吧

Q：OK，那分析一下delete的过程

A：先析构，再回收空间

Q：用哪个函数回收呢？

A：delete operator - operator delete - C的free函数，牵涉到底层内存管理，

Q：free要指定长度吗

A：不用

Q：这是不是就是上一个问题的答案呢？

A：（恍然大悟）哦~所以这些成员变量相当于向前在类里面，在free类对象的时候也回收掉了

vector与list的区别---从连续内存与非连续内存的角度分析了一下性能

Q：vector当capacity不够时，需要重写申请空间-copy-销毁旧空间，这个时间复杂度是多少

A：单这个行为是O(n)

Q：那为什么push_back是O(1)呢

A：摊还分析，前面经历了很多次O(1)的push_back，这次O(n)push_back可以把时间摊还到前面去，所以整体是O(1)

Q：如果出现扩容，原本迭代器会失效吗，为什么？

A：vector迭代器底层是原生指针，指向原来的地址，扩容后需要搬运，所以原来的地址失效了

Q：那如果要你重新设计vector的话，要怎么样才能让迭代器不失效呢

A：迭代器中除了原生指针，还需要加入相对于begin()的偏移量

STL map底层是啥，为啥选红黑树不选AVL树，AVL树插入和删除最坏情况（O(n)），为什么不用B+树

Q：你说的B+树在数据库场景下能减少IO次数，应该指的是能减少IO次数，那如果是SSD有什么不同

A：（我的天，这是啥问题）这个。。。不太清楚

Q：那换个问题，SSD与机械硬盘的优缺点

A：（不是很清楚SSD的原理）SSD好像是什么二极管，有很多格子，用电激活起来，比较脆弱，随机读写性能更好。机械硬盘的随机读写性能比较差，因为它是有磁头的，磁头要去寻道，这牵涉到很多寻道算法，比如电梯算法，但是还是要移动磁头，所以性能较差巴拉巴拉

Q：emmm 差不多吧，不是因为SSD太强，而是因为对手太弱了

STL内存配置器有重写过吗（没有）

进程与线程的区别，线程私有变量是什么（回答不清楚，面试官说这是很关键的一个点，复盘时我才听清是thread local storage线程局部存储，不过我也不会）

多线程与单线程的优劣

STL容器是线程安全的吗（不是），有什么需要注意的（加锁与同步）

Q：多个线程读vector的内容需要加锁吗

A：不需要

Q：如果很多线程读，一个线程写，用什么锁比较好

A：读写锁吧

Q：读写锁有两种设计方式，一种是写优先、一种是读优先，写优先怎么做

A：写的时候，加锁，排斥其他的读

Q：读优先呢？

A：多个线程都能读，一个线程写的时候加锁

Q：emmm 读写锁本来就是要这样的（沉默了一会）OK吧，下一道题

C++11的atomic有听过吗（有），有几种内存模型（不知道）

服务端用accept，成功返回，说明三次握手完成了几次

A：（没搞懂他的问题，僵了好久）三次吧

Q：emmm ok，如果已经建立连接，那客户端如果连续发三次100字节的TCP包，那服务端有哪几种可能性呢

A：首先看不需要分片，100字节小于互联网场景的MTU，不需要分片，如果在不丢包的情况下，会收到三个包

Q：有没有可能收到一个300字节的大包

A：有可能，TCP是面向字节流的，服务端不知道消息的长度，在接收缓冲区读一定长度的字节，所以需要做粘包的处理

回到项目，华为比赛，可以用分布式吗，考虑一下

有写过分布式程序吗（没有），有了解分布式吗（知道CAP定理），现实中选择CAP中的哪项丢弃（A不能，CP看情况），什么情况下把P舍弃掉（我听错了，回答NoSQL把P舍弃掉了，复盘时才知道答非所问，面试官没说什么）

## 虎牙二面

4.2 牛客视频，45min

项目

STL容器有哪些（按照STL源码剖析的顺序讲了一遍）

Q：红黑树和哈希表，什么场景用呢

A：有序无序，时间复杂度（查找、插入/删除）、哈希表内存更大一点（一般是数据总量N*2，而且是质数）

Q：既然提到了内存，epoll里面是啥数据结构，为什么呢

A：红黑树，epoll_ctrl需要经常插入或删除，红黑树可以以更稳定的Ologn时间复杂度，哈希表在不断插入时可能需要rehash，在不断删除时原先开辟2N空间又会大大浪费

Q：emm这是内存的消耗，那我举个例子，假设TCP连接有十万个，内存消耗有多少呢？

A：单单一个TCP连接只消耗一个文件描述符fd，一个TCP连接有接收缓冲区与发送缓冲区，内存单位可能是K，取决于具体实现

Q：emm 是的，内存这也是一个点，但是在小场景下，哈希表浪费的内存也没有太大，有没有更重要的关注点

A：在时间上，哈希表可能需要rehash，红黑树在插入和删除后，最多两次还是三次就可以达到平衡，更加稳定

Q：emm 还有没有其他的点，可以影响到你红黑树与哈希表的选型呢

A：emmm

Q：工程上就是不断地取舍，再想想

A：（一番思考）我想到了一种场景，类似于数据库要用B+树的原因，要进入哈希表的数据需要经过哈希函数，可能会散落在哈希表各个地方，没有规律；红黑树是一种有序结果，相似的项目就在附近，所以遍历查找会更快一点

Q：（分析了一通）不是很确定，回头可以验证一下。其实还有个很重要的点，你没想到，那就是重载的问题，可能这个数据根本无法比大小

A：哦~嗯。。。那这个可能也算在有序无序的区别里面？

Q：也就是operator < 压根不能使用，这个时候不能用红黑树

A：哦~对对对，有道理

进程与线程的区别（巴拉巴拉，还说了一面完后学的thread local storage）

Q：（当我说到线程有自己独有的栈段与寄存器时，打断）为什么线程会有独有的寄存器，放在那里？

A：噢噢，我说的是程序计数寄存器

Q：emm 那放在哪里呢，比如我开一万个线程，就有一万个寄存器跑出来？

A：CPU里面吧，可能是L1 L2缓存里面，当我要调度下一个线程，就从缓存中把相应的程序计数寄存器读取出来（我的说法容易引起歧义，寄存器是一个个物理的、真实存在的元件）

Q：（解释了一通）寄存器应该是轮流占坑的东西

A：是是是是，我是这个意思

Q：有听说过协程吗

A：交织式的子程序，C++20，微信开源了协程库libco巴拉巴拉，具体怎么实现与应用场景坦白不是很清楚

Q：你说到了C++20，你对C++的新标准有什么了解呢

A：C++20有个Ranges，是对于区间范围的升华，好像传入泛型算法里的参数可以有更多的范围形式，巴拉巴拉，具体有点忘了

Q：如果想做左开右闭怎么办

A：把begin和end往前移一下

Q：ok 这不是很重要的事情

Q：条件变量为什么要传入一个锁，为什么不放在内部呢，就像printf一样，对缓冲区加锁解锁，用户不需要关心

（一来一回聊了很久，我始终没有答到点上，但是竭尽全力把自己的知识都吐出来了）

TCP与UDP的区别（我讲了很多很多，聊到自己搭建服务器用了bbr拥塞控制算法什么的）

Q：DNS为什么用UDP

A：包更多、对网络消耗更大、时间更多

Q：http dns有听过吗，就是用http来实现dns

A：（刚开始没听懂，解释了一番dns）哦。。是用http来做dns，没听过

Q：P2P，你觉得用TCP和UDP

A：我想想，点对点，我觉得是TCP吧，因为传输很大的字节流，要保证完整，所以我觉得是用TCP做的

Q：但是其实是用UDP做的

A：（尴尬）啊这样子的嘛。。（傻笑）

虎牙直播，弹幕的字数是1-30个字，后台有100w个敏感词数据库，怎么样实现屏蔽效果，注意是包含，可能有几个字是敏感词，也需要屏蔽

A：分词巴拉巴拉，nlp巴拉巴拉，布隆过滤器巴拉巴拉，哈希表巴拉巴拉

Q：分词属于nlp范畴了，感觉有点太过了，我想问的是nlp的一个子问题，而且我想要的是包含逻辑，不是匹配逻辑（特指布隆过滤器）

A：kmp算法？巴拉巴拉

Q：那得运行很多遍，不用这么复杂

A：（想了一会）好像在搜索引擎中，可以联想关键词，好像用到了一种叫做什么trie树来着

Q：那怎么具体怎么解决的呢

A：emm 具体有点不太了解

Q：ok我没什么问题了，你有什么问题可以问我

A：我想问一下刚才这道题，您最期待的答案是什么

Q：emm 这有很多种解法，有挫一点的也有高大上一点，比如AC自动机，树，或者自己构造一个树，trie树什么的

A：那虎牙直播是怎么解决的呢

Q：最开始我写的一个版本是用到了类似的，后来用了AI，现在还支持拼音，还有更多的组合，你可以自己写一写，挺有意思的

A：您觉得我还有什么提高的吗

Q：基础还可以，有些点没答上来（觉得我p2p那里没回答出来有点可惜），其他的还好

总结：面试官很友好，整个面试像一场技术探讨，很多东西我可以自由发挥，我说的一些点，面试官也在思考，感觉不错

半小时后HR电话，通过二面啦

## 虎牙三面

4.3 电话 15min

为了找C++后台开发岗位，你做了哪些准备

项目做了什么，有什么收获（每个项目都聊了一会）

网络编程了解多少（看了UNP、APUE，还看了陈硕大神写的Muduo网络库，但由于时间关系没来得及自己造轮子，巴拉巴拉）

半小时后HR电话，通过三面啦

## 虎牙HR面（已拿offer）

4.3 电话 15min

为啥投虎牙，啥时候看虎牙直播的，对虎牙有其他了解吗

有投其他公司的吗，怎么抉择

啥时候能来实习
